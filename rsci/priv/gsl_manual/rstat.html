

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Running Statistics &mdash; GSL 2.8 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Moving Window Statistics" href="movstat.html" />
    <link rel="prev" title="Statistics" href="statistics.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> GSL
          

          
          </a>

          
            
            
              <div class="version">
                2.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Using the Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="err.html">Error Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="math.html">Mathematical Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="complex.html">Complex Numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="poly.html">Polynomials</a></li>
<li class="toctree-l1"><a class="reference internal" href="specfunc.html">Special Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectors.html">Vectors and Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="permutation.html">Permutations</a></li>
<li class="toctree-l1"><a class="reference internal" href="combination.html">Combinations</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiset.html">Multisets</a></li>
<li class="toctree-l1"><a class="reference internal" href="sort.html">Sorting</a></li>
<li class="toctree-l1"><a class="reference internal" href="blas.html">BLAS Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="linalg.html">Linear Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="eigen.html">Eigensystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="fft.html">Fast Fourier Transforms (FFTs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="integration.html">Numerical Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="rng.html">Random Number Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="qrng.html">Quasi-Random Sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="randist.html">Random Number Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="statistics.html">Statistics</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Running Statistics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#initializing-the-accumulator">Initializing the Accumulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-data-to-the-accumulator">Adding Data to the Accumulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#current-statistics">Current Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quantiles">Quantiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references-and-further-reading">References and Further Reading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="movstat.html">Moving Window Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="filter.html">Digital Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="histogram.html">Histograms</a></li>
<li class="toctree-l1"><a class="reference internal" href="ntuple.html">N-tuples</a></li>
<li class="toctree-l1"><a class="reference internal" href="montecarlo.html">Monte Carlo Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="siman.html">Simulated Annealing</a></li>
<li class="toctree-l1"><a class="reference internal" href="ode-initval.html">Ordinary Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="interp.html">Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="diff.html">Numerical Differentiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="cheb.html">Chebyshev Approximations</a></li>
<li class="toctree-l1"><a class="reference internal" href="sum.html">Series Acceleration</a></li>
<li class="toctree-l1"><a class="reference internal" href="dwt.html">Wavelet Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="dht.html">Discrete Hankel Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="roots.html">One Dimensional Root-Finding</a></li>
<li class="toctree-l1"><a class="reference internal" href="min.html">One Dimensional Minimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiroots.html">Multidimensional Root-Finding</a></li>
<li class="toctree-l1"><a class="reference internal" href="multimin.html">Multidimensional Minimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="lls.html">Linear Least-Squares Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="nls.html">Nonlinear Least-Squares Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="bspline.html">Basis Splines</a></li>
<li class="toctree-l1"><a class="reference internal" href="spmatrix.html">Sparse Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="spblas.html">Sparse BLAS Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="splinalg.html">Sparse Linear Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="const.html">Physical Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="ieee754.html">IEEE floating-point arithmetic</a></li>
<li class="toctree-l1"><a class="reference internal" href="debug.html">Debugging Numerical Programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="contrib.html">Contributors to GSL</a></li>
<li class="toctree-l1"><a class="reference internal" href="autoconf.html">Autoconf Macros</a></li>
<li class="toctree-l1"><a class="reference internal" href="cblas.html">GSL CBLAS Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpl.html">GNU General Public License</a></li>
<li class="toctree-l1"><a class="reference internal" href="fdl.html">GNU Free Documentation License</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GSL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Running Statistics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/rstat.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="movstat.html" class="btn btn-neutral float-right" title="Moving Window Statistics" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="statistics.html" class="btn btn-neutral float-left" title="Statistics" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="running-statistics">
<span id="index-0"></span><h1>Running Statistics<a class="headerlink" href="#running-statistics" title="Permalink to this heading">¶</a></h1>
<p>This chapter describes routines for computing running statistics,
also known as online statistics, of data. These routines are
suitable for handling large datasets for which it may be
inconvenient or impractical to store in memory all at once.
The data can be processed in a single pass, one point at a time.
Each time a data point is added to the accumulator, internal
parameters are updated in order to compute the current mean, variance,
standard deviation, skewness, and kurtosis. These statistics are
exact, and are updated with numerically stable single-pass algorithms.
The median and arbitrary quantiles are also available, however these
calculations use algorithms which provide approximations, and grow
more accurate as more data is added to the accumulator.</p>
<p>The functions described in this chapter are declared in the header file
<code class="file docutils literal notranslate"><span class="pre">gsl_rstat.h</span></code>.</p>
<div class="section" id="initializing-the-accumulator">
<h2>Initializing the Accumulator<a class="headerlink" href="#initializing-the-accumulator" title="Permalink to this heading">¶</a></h2>
<dl class="c type">
<dt class="sig sig-object c" id="c.gsl_rstat_workspace">
<span class="k"><span class="pre">type</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_workspace</span></span></span><a class="headerlink" href="#c.gsl_rstat_workspace" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This workspace contains parameters used to calculate various statistics
and are updated after each data point is added to the accumulator.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_alloc">
<a class="reference internal" href="#c.gsl_rstat_workspace" title="gsl_rstat_workspace"><span class="n"><span class="pre">gsl_rstat_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_alloc</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_alloc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function allocates a workspace for computing running statistics.
The size of the workspace is <img class="math" src="_images/math/7a8c96471eb27bf3896037e79cd6bf6262bd5fb6.png" alt="O(1)"/>.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_free">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.gsl_rstat_workspace" title="gsl_rstat_workspace"><span class="n"><span class="pre">gsl_rstat_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_free" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function frees the memory associated with the workspace <a class="reference internal" href="#c.gsl_rstat_free" title="w"><code class="xref c c-data docutils literal notranslate"><span class="pre">w</span></code></a>.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_reset">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_reset</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.gsl_rstat_workspace" title="gsl_rstat_workspace"><span class="n"><span class="pre">gsl_rstat_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_reset" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function resets the workspace <a class="reference internal" href="#c.gsl_rstat_reset" title="w"><code class="xref c c-data docutils literal notranslate"><span class="pre">w</span></code></a> to its initial state,
so it can begin working on a new set of data.</p>
</dd></dl>

</div>
<div class="section" id="adding-data-to-the-accumulator">
<h2>Adding Data to the Accumulator<a class="headerlink" href="#adding-data-to-the-accumulator" title="Permalink to this heading">¶</a></h2>
<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_add">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_add</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">x</span></span>, <a class="reference internal" href="#c.gsl_rstat_workspace" title="gsl_rstat_workspace"><span class="n"><span class="pre">gsl_rstat_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_add" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function adds the data point <a class="reference internal" href="#c.gsl_rstat_add" title="x"><code class="xref c c-data docutils literal notranslate"><span class="pre">x</span></code></a> to the statistical
accumulator, updating calculations of the mean, variance,
standard deviation, skewness, kurtosis, and median.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_n">
<span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_n</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.gsl_rstat_workspace" title="gsl_rstat_workspace"><span class="n"><span class="pre">gsl_rstat_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_n" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function returns the number of data so far added to the accumulator.</p>
</dd></dl>

</div>
<div class="section" id="current-statistics">
<h2>Current Statistics<a class="headerlink" href="#current-statistics" title="Permalink to this heading">¶</a></h2>
<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_min">
<span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_min</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.gsl_rstat_workspace" title="gsl_rstat_workspace"><span class="n"><span class="pre">gsl_rstat_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_min" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function returns the minimum value added to the accumulator.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_max">
<span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_max</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.gsl_rstat_workspace" title="gsl_rstat_workspace"><span class="n"><span class="pre">gsl_rstat_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_max" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function returns the maximum value added to the accumulator.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_mean">
<span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_mean</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.gsl_rstat_workspace" title="gsl_rstat_workspace"><span class="n"><span class="pre">gsl_rstat_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_mean" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function returns the mean of all data added to the accumulator,
defined as</p>
<div class="math">
<p><img src="_images/math/0189a8802f72aebfd1c6147207f5c905c21776c7.png" alt="{\Hat\mu} = {1 \over N} \sum x_i"/></p>
</div></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_variance">
<span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_variance</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.gsl_rstat_workspace" title="gsl_rstat_workspace"><span class="n"><span class="pre">gsl_rstat_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_variance" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function returns the variance of all data added to the accumulator,
defined as</p>
<div class="math">
<p><img src="_images/math/ced349876b3170ba31383915185040b31fa9cb0e.png" alt="{\Hat\sigma}^2 = {1 \over (N-1)} \sum (x_i - {\Hat\mu})^2"/></p>
</div></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_sd">
<span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_sd</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.gsl_rstat_workspace" title="gsl_rstat_workspace"><span class="n"><span class="pre">gsl_rstat_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_sd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function returns the standard deviation of all data added to the
accumulator, defined as the square root of the variance given above.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_sd_mean">
<span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_sd_mean</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.gsl_rstat_workspace" title="gsl_rstat_workspace"><span class="n"><span class="pre">gsl_rstat_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_sd_mean" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function returns the standard deviation of the mean, defined as</p>
<div class="math">
<p><img src="_images/math/75141f6398cd8251817524e876c26b3cb48ed467.png" alt="\Hat\sigma_{\Hat\mu} = {\Hat\sigma \over \sqrt{N}}"/></p>
</div></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_rms">
<span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_rms</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.gsl_rstat_workspace" title="gsl_rstat_workspace"><span class="n"><span class="pre">gsl_rstat_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_rms" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function returns the root mean square of all data added to the
accumulator, defined as</p>
<div class="math">
<p><img src="_images/math/5ce3d798e3ebb3e4b7c1406f8be66f5b7b76ca20.png" alt="rms = \sqrt{{1 \over N} \sum x_i^2}"/></p>
</div></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_skew">
<span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_skew</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.gsl_rstat_workspace" title="gsl_rstat_workspace"><span class="n"><span class="pre">gsl_rstat_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_skew" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function returns the skewness of all data added to the accumulator,
defined as</p>
<div class="math">
<p><img src="_images/math/e7d84d4a573aae3fbeb49e4ad537d72b74c716a6.png" alt="skew = {1 \over N} \sum
 {\left( x_i - {\Hat\mu} \over {\Hat\sigma} \right)}^3"/></p>
</div></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_kurtosis">
<span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_kurtosis</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.gsl_rstat_workspace" title="gsl_rstat_workspace"><span class="n"><span class="pre">gsl_rstat_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_kurtosis" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function returns the kurtosis of all data added to the accumulator,
defined as</p>
<div class="math">
<p><img src="_images/math/aa4277a318a1ceaef554bbc83fd0963a60ffe4c8.png" alt="kurtosis = \left( {1 \over N} \sum
 {\left(x_i - {\Hat\mu} \over {\Hat\sigma} \right)}^4
 \right)
 - 3"/></p>
</div></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_median">
<span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_median</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.gsl_rstat_workspace" title="gsl_rstat_workspace"><span class="n"><span class="pre">gsl_rstat_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_median" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function returns an estimate of the median of the data added to
the accumulator.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_norm">
<span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_norm</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.gsl_rstat_workspace" title="gsl_rstat_workspace"><span class="n"><span class="pre">gsl_rstat_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_norm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function returns the Euclidean norm of all data added to the
accumulator, defined as</p>
<div class="math">
<p><img src="_images/math/7433ffcd8bb908bae10137171203c3eba5c8673f.png" alt="\left|\left| x \right|\right| = \sqrt{\sum x_i^2}"/></p>
</div></dd></dl>

</div>
<div class="section" id="quantiles">
<h2>Quantiles<a class="headerlink" href="#quantiles" title="Permalink to this heading">¶</a></h2>
<p>The functions in this section estimate quantiles dynamically without
storing the entire dataset, using the algorithm of Jain and Chlamtec, 1985.
Only five points (markers) are stored which represent the minimum
and maximum of the data, as well as current estimates of the
<img class="math" src="_images/math/2c987126e6915e587a350058daacbfab235743cf.png" alt="p/2"/>-, <img class="math" src="_images/math/fb0d29f420855f76f8e9deaf5ff8c5580e97a4f0.png" alt="p"/>-, and <img class="math" src="_images/math/4d9d557d1e2248bf7fcdc1bf189260af6273fb3d.png" alt="(1+p)/2"/>-quantiles. Each time
a new data point is added, the marker positions and heights are
updated.</p>
<dl class="c type">
<dt class="sig sig-object c" id="c.gsl_rstat_quantile_workspace">
<span class="k"><span class="pre">type</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_quantile_workspace</span></span></span><a class="headerlink" href="#c.gsl_rstat_quantile_workspace" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This workspace contains parameters for estimating quantiles of the
current dataset</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_quantile_alloc">
<a class="reference internal" href="#c.gsl_rstat_quantile_workspace" title="gsl_rstat_quantile_workspace"><span class="n"><span class="pre">gsl_rstat_quantile_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_quantile_alloc</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">p</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_quantile_alloc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function allocates a workspace for the dynamic estimation of
<a class="reference internal" href="#c.gsl_rstat_quantile_alloc" title="p"><code class="xref c c-data docutils literal notranslate"><span class="pre">p</span></code></a>-quantiles, where <a class="reference internal" href="#c.gsl_rstat_quantile_alloc" title="p"><code class="xref c c-data docutils literal notranslate"><span class="pre">p</span></code></a> is between <img class="math" src="_images/math/77bfa83830305fac291e4e73b780e4cc9458b293.png" alt="0"/> and <img class="math" src="_images/math/083794f6b6375b92a331ddd53c8cc62a3a0a2a6d.png" alt="1"/>.
The median corresponds to <img class="math" src="_images/math/0629b483c0d1f45936032902416767c002e79fce.png" alt="p = 0.5"/>. The size of the workspace
is <img class="math" src="_images/math/7a8c96471eb27bf3896037e79cd6bf6262bd5fb6.png" alt="O(1)"/>.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_quantile_free">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_quantile_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.gsl_rstat_quantile_workspace" title="gsl_rstat_quantile_workspace"><span class="n"><span class="pre">gsl_rstat_quantile_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_quantile_free" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function frees the memory associated with the workspace <a class="reference internal" href="#c.gsl_rstat_quantile_free" title="w"><code class="xref c c-data docutils literal notranslate"><span class="pre">w</span></code></a>.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_quantile_reset">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_quantile_reset</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.gsl_rstat_quantile_workspace" title="gsl_rstat_quantile_workspace"><span class="n"><span class="pre">gsl_rstat_quantile_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_quantile_reset" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function resets the workspace <a class="reference internal" href="#c.gsl_rstat_quantile_reset" title="w"><code class="xref c c-data docutils literal notranslate"><span class="pre">w</span></code></a> to its initial state,
so it can begin working on a new set of data.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_quantile_add">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_quantile_add</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">x</span></span>, <a class="reference internal" href="#c.gsl_rstat_quantile_workspace" title="gsl_rstat_quantile_workspace"><span class="n"><span class="pre">gsl_rstat_quantile_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_quantile_add" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function updates the estimate of the <img class="math" src="_images/math/fb0d29f420855f76f8e9deaf5ff8c5580e97a4f0.png" alt="p"/>-quantile with
the new data point <a class="reference internal" href="#c.gsl_rstat_quantile_add" title="x"><code class="xref c c-data docutils literal notranslate"><span class="pre">x</span></code></a>.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_rstat_quantile_get">
<span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_rstat_quantile_get</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.gsl_rstat_quantile_workspace" title="gsl_rstat_quantile_workspace"><span class="n"><span class="pre">gsl_rstat_quantile_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_rstat_quantile_get" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function returns the current estimate of the <img class="math" src="_images/math/fb0d29f420855f76f8e9deaf5ff8c5580e97a4f0.png" alt="p"/>-quantile.</p>
</dd></dl>

</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h2>
<p>Here is a basic example of how to use the statistical functions:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;stdio.h&gt;</span>
<span class="c1">#include &lt;gsl/gsl_rstat.h&gt;</span>

<span class="nb">int</span>
<span class="n">main</span><span class="p">(</span><span class="n">void</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">double</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mf">17.2</span><span class="p">,</span> <span class="mf">18.1</span><span class="p">,</span> <span class="mf">16.5</span><span class="p">,</span> <span class="mf">18.3</span><span class="p">,</span> <span class="mf">12.6</span><span class="p">};</span>
  <span class="n">double</span> <span class="n">mean</span><span class="p">,</span> <span class="n">variance</span><span class="p">,</span> <span class="n">largest</span><span class="p">,</span> <span class="n">smallest</span><span class="p">,</span> <span class="n">sd</span><span class="p">,</span>
         <span class="n">rms</span><span class="p">,</span> <span class="n">sd_mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">skew</span><span class="p">,</span> <span class="n">kurtosis</span><span class="p">;</span>
  <span class="n">gsl_rstat_workspace</span> <span class="o">*</span><span class="n">rstat_p</span> <span class="o">=</span> <span class="n">gsl_rstat_alloc</span><span class="p">();</span>
  <span class="n">size_t</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">;</span>

  <span class="o">/*</span> <span class="n">add</span> <span class="n">data</span> <span class="n">to</span> <span class="n">rstat</span> <span class="n">accumulator</span> <span class="o">*/</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
    <span class="n">gsl_rstat_add</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">rstat_p</span><span class="p">);</span>

  <span class="n">mean</span>     <span class="o">=</span> <span class="n">gsl_rstat_mean</span><span class="p">(</span><span class="n">rstat_p</span><span class="p">);</span>
  <span class="n">variance</span> <span class="o">=</span> <span class="n">gsl_rstat_variance</span><span class="p">(</span><span class="n">rstat_p</span><span class="p">);</span>
  <span class="n">largest</span>  <span class="o">=</span> <span class="n">gsl_rstat_max</span><span class="p">(</span><span class="n">rstat_p</span><span class="p">);</span>
  <span class="n">smallest</span> <span class="o">=</span> <span class="n">gsl_rstat_min</span><span class="p">(</span><span class="n">rstat_p</span><span class="p">);</span>
  <span class="n">median</span>   <span class="o">=</span> <span class="n">gsl_rstat_median</span><span class="p">(</span><span class="n">rstat_p</span><span class="p">);</span>
  <span class="n">sd</span>       <span class="o">=</span> <span class="n">gsl_rstat_sd</span><span class="p">(</span><span class="n">rstat_p</span><span class="p">);</span>
  <span class="n">sd_mean</span>  <span class="o">=</span> <span class="n">gsl_rstat_sd_mean</span><span class="p">(</span><span class="n">rstat_p</span><span class="p">);</span>
  <span class="n">skew</span>     <span class="o">=</span> <span class="n">gsl_rstat_skew</span><span class="p">(</span><span class="n">rstat_p</span><span class="p">);</span>
  <span class="n">rms</span>      <span class="o">=</span> <span class="n">gsl_rstat_rms</span><span class="p">(</span><span class="n">rstat_p</span><span class="p">);</span>
  <span class="n">kurtosis</span> <span class="o">=</span> <span class="n">gsl_rstat_kurtosis</span><span class="p">(</span><span class="n">rstat_p</span><span class="p">);</span>
  <span class="n">n</span>        <span class="o">=</span> <span class="n">gsl_rstat_n</span><span class="p">(</span><span class="n">rstat_p</span><span class="p">);</span>

  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;The dataset is </span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
         <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>

  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;The sample mean is </span><span class="si">%g</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">mean</span><span class="p">);</span>
  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;The estimated variance is </span><span class="si">%g</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">variance</span><span class="p">);</span>
  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;The largest value is </span><span class="si">%g</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">largest</span><span class="p">);</span>
  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;The smallest value is </span><span class="si">%g</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">smallest</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span> <span class="s2">&quot;The median is </span><span class="si">%g</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">median</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span> <span class="s2">&quot;The standard deviation is </span><span class="si">%g</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">sd</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span> <span class="s2">&quot;The root mean square is </span><span class="si">%g</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">rms</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span> <span class="s2">&quot;The standard devation of the mean is </span><span class="si">%g</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">sd_mean</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span> <span class="s2">&quot;The skew is </span><span class="si">%g</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">skew</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span> <span class="s2">&quot;The kurtosis </span><span class="si">%g</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">kurtosis</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span> <span class="s2">&quot;There are %zu items in the accumulator</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>

  <span class="n">gsl_rstat_reset</span><span class="p">(</span><span class="n">rstat_p</span><span class="p">);</span>
  <span class="n">n</span> <span class="o">=</span> <span class="n">gsl_rstat_n</span><span class="p">(</span><span class="n">rstat_p</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span> <span class="s2">&quot;There are %zu items in the accumulator</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>

  <span class="n">gsl_rstat_free</span><span class="p">(</span><span class="n">rstat_p</span><span class="p">);</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The program should produce the following output,</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">dataset</span> <span class="ow">is</span> <span class="mf">17.2</span><span class="p">,</span> <span class="mf">18.1</span><span class="p">,</span> <span class="mf">16.5</span><span class="p">,</span> <span class="mf">18.3</span><span class="p">,</span> <span class="mf">12.6</span>
<span class="n">The</span> <span class="n">sample</span> <span class="n">mean</span> <span class="ow">is</span> <span class="mf">16.54</span>
<span class="n">The</span> <span class="n">estimated</span> <span class="n">variance</span> <span class="ow">is</span> <span class="mf">5.373</span>
<span class="n">The</span> <span class="n">largest</span> <span class="n">value</span> <span class="ow">is</span> <span class="mf">18.3</span>
<span class="n">The</span> <span class="n">smallest</span> <span class="n">value</span> <span class="ow">is</span> <span class="mf">12.6</span>
<span class="n">The</span> <span class="n">median</span> <span class="ow">is</span> <span class="mf">17.2</span>
<span class="n">The</span> <span class="n">standard</span> <span class="n">deviation</span> <span class="ow">is</span> <span class="mf">2.31797</span>
<span class="n">The</span> <span class="n">root</span> <span class="n">mean</span> <span class="n">square</span> <span class="ow">is</span> <span class="mf">16.6694</span>
<span class="n">The</span> <span class="n">standard</span> <span class="n">devation</span> <span class="n">of</span> <span class="n">the</span> <span class="n">mean</span> <span class="ow">is</span> <span class="mf">1.03663</span>
<span class="n">The</span> <span class="n">skew</span> <span class="ow">is</span> <span class="o">-</span><span class="mf">0.829058</span>
<span class="n">The</span> <span class="n">kurtosis</span> <span class="o">-</span><span class="mf">1.2217</span>
<span class="n">There</span> <span class="n">are</span> <span class="mi">5</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">accumulator</span>
<span class="n">There</span> <span class="n">are</span> <span class="mi">0</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">accumulator</span>
</pre></div>
</div>
<p>This next program estimates the lower quartile, median and upper
quartile from 10,000 samples of a random Rayleigh distribution,
using the <img class="math" src="_images/math/a0b67947ad3da1cf09d847e601aed8665063b3a1.png" alt="P^2"/> algorithm of Jain and Chlamtec. For
comparison, the exact values are also computed from the sorted
dataset.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;stdio.h&gt;</span>
<span class="c1">#include &lt;stdlib.h&gt;</span>
<span class="c1">#include &lt;gsl/gsl_rstat.h&gt;</span>
<span class="c1">#include &lt;gsl/gsl_statistics.h&gt;</span>
<span class="c1">#include &lt;gsl/gsl_rng.h&gt;</span>
<span class="c1">#include &lt;gsl/gsl_randist.h&gt;</span>
<span class="c1">#include &lt;gsl/gsl_sort.h&gt;</span>

<span class="nb">int</span>
<span class="n">main</span><span class="p">(</span><span class="n">void</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">const</span> <span class="n">size_t</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">;</span>
  <span class="n">double</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">double</span><span class="p">));</span>
  <span class="n">gsl_rstat_quantile_workspace</span> <span class="o">*</span><span class="n">work_25</span> <span class="o">=</span> <span class="n">gsl_rstat_quantile_alloc</span><span class="p">(</span><span class="mf">0.25</span><span class="p">);</span>
  <span class="n">gsl_rstat_quantile_workspace</span> <span class="o">*</span><span class="n">work_50</span> <span class="o">=</span> <span class="n">gsl_rstat_quantile_alloc</span><span class="p">(</span><span class="mf">0.5</span><span class="p">);</span>
  <span class="n">gsl_rstat_quantile_workspace</span> <span class="o">*</span><span class="n">work_75</span> <span class="o">=</span> <span class="n">gsl_rstat_quantile_alloc</span><span class="p">(</span><span class="mf">0.75</span><span class="p">);</span>
  <span class="n">gsl_rng</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="n">gsl_rng_alloc</span><span class="p">(</span><span class="n">gsl_rng_default</span><span class="p">);</span>
  <span class="n">double</span> <span class="n">exact_p25</span><span class="p">,</span> <span class="n">exact_p50</span><span class="p">,</span> <span class="n">exact_p75</span><span class="p">;</span>
  <span class="n">double</span> <span class="n">val_p25</span><span class="p">,</span> <span class="n">val_p50</span><span class="p">,</span> <span class="n">val_p75</span><span class="p">;</span>
  <span class="n">size_t</span> <span class="n">i</span><span class="p">;</span>

  <span class="o">/*</span> <span class="n">add</span> <span class="n">data</span> <span class="n">to</span> <span class="n">quantile</span> <span class="n">accumulators</span><span class="p">;</span> <span class="n">also</span> <span class="n">store</span> <span class="n">data</span> <span class="k">for</span> <span class="n">exact</span>
   <span class="o">*</span> <span class="n">comparisons</span> <span class="o">*/</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">gsl_ran_rayleigh</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
      <span class="n">gsl_rstat_quantile_add</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">work_25</span><span class="p">);</span>
      <span class="n">gsl_rstat_quantile_add</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">work_50</span><span class="p">);</span>
      <span class="n">gsl_rstat_quantile_add</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">work_75</span><span class="p">);</span>
    <span class="p">}</span>

  <span class="o">/*</span> <span class="n">exact</span> <span class="n">values</span> <span class="o">*/</span>
  <span class="n">gsl_sort</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">);</span>
  <span class="n">exact_p25</span> <span class="o">=</span> <span class="n">gsl_stats_quantile_from_sorted_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">);</span>
  <span class="n">exact_p50</span> <span class="o">=</span> <span class="n">gsl_stats_quantile_from_sorted_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span>
  <span class="n">exact_p75</span> <span class="o">=</span> <span class="n">gsl_stats_quantile_from_sorted_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">);</span>

  <span class="o">/*</span> <span class="n">estimated</span> <span class="n">values</span> <span class="o">*/</span>
  <span class="n">val_p25</span> <span class="o">=</span> <span class="n">gsl_rstat_quantile_get</span><span class="p">(</span><span class="n">work_25</span><span class="p">);</span>
  <span class="n">val_p50</span> <span class="o">=</span> <span class="n">gsl_rstat_quantile_get</span><span class="p">(</span><span class="n">work_50</span><span class="p">);</span>
  <span class="n">val_p75</span> <span class="o">=</span> <span class="n">gsl_rstat_quantile_get</span><span class="p">(</span><span class="n">work_75</span><span class="p">);</span>

  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;The dataset is </span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">, ...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
         <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>

  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;0.25 quartile: exact = </span><span class="si">%.5f</span><span class="s2">, estimated = </span><span class="si">%.5f</span><span class="s2">, error = </span><span class="si">%.6e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
          <span class="n">exact_p25</span><span class="p">,</span> <span class="n">val_p25</span><span class="p">,</span> <span class="p">(</span><span class="n">val_p25</span> <span class="o">-</span> <span class="n">exact_p25</span><span class="p">)</span> <span class="o">/</span> <span class="n">exact_p25</span><span class="p">);</span>
  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;0.50 quartile: exact = </span><span class="si">%.5f</span><span class="s2">, estimated = </span><span class="si">%.5f</span><span class="s2">, error = </span><span class="si">%.6e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
          <span class="n">exact_p50</span><span class="p">,</span> <span class="n">val_p50</span><span class="p">,</span> <span class="p">(</span><span class="n">val_p50</span> <span class="o">-</span> <span class="n">exact_p50</span><span class="p">)</span> <span class="o">/</span> <span class="n">exact_p50</span><span class="p">);</span>
  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;0.75 quartile: exact = </span><span class="si">%.5f</span><span class="s2">, estimated = </span><span class="si">%.5f</span><span class="s2">, error = </span><span class="si">%.6e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
          <span class="n">exact_p75</span><span class="p">,</span> <span class="n">val_p75</span><span class="p">,</span> <span class="p">(</span><span class="n">val_p75</span> <span class="o">-</span> <span class="n">exact_p75</span><span class="p">)</span> <span class="o">/</span> <span class="n">exact_p75</span><span class="p">);</span>

  <span class="n">gsl_rstat_quantile_free</span><span class="p">(</span><span class="n">work_25</span><span class="p">);</span>
  <span class="n">gsl_rstat_quantile_free</span><span class="p">(</span><span class="n">work_50</span><span class="p">);</span>
  <span class="n">gsl_rstat_quantile_free</span><span class="p">(</span><span class="n">work_75</span><span class="p">);</span>
  <span class="n">gsl_rng_free</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
  <span class="n">free</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The program should produce the following output,</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">dataset</span> <span class="ow">is</span> <span class="mf">0.00645272</span><span class="p">,</span> <span class="mf">0.0074002</span><span class="p">,</span> <span class="mf">0.0120706</span><span class="p">,</span> <span class="mf">0.0207256</span><span class="p">,</span> <span class="mf">0.0227282</span><span class="p">,</span> <span class="o">...</span>
<span class="mf">0.25</span> <span class="n">quartile</span><span class="p">:</span> <span class="n">exact</span> <span class="o">=</span> <span class="mf">0.75766</span><span class="p">,</span> <span class="n">estimated</span> <span class="o">=</span> <span class="mf">0.75580</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.450209e-03</span>
<span class="mf">0.50</span> <span class="n">quartile</span><span class="p">:</span> <span class="n">exact</span> <span class="o">=</span> <span class="mf">1.17508</span><span class="p">,</span> <span class="n">estimated</span> <span class="o">=</span> <span class="mf">1.17438</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.995912e-04</span>
<span class="mf">0.75</span> <span class="n">quartile</span><span class="p">:</span> <span class="n">exact</span> <span class="o">=</span> <span class="mf">1.65347</span><span class="p">,</span> <span class="n">estimated</span> <span class="o">=</span> <span class="mf">1.65696</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="mf">2.110571e-03</span>
</pre></div>
</div>
</div>
<div class="section" id="references-and-further-reading">
<h2>References and Further Reading<a class="headerlink" href="#references-and-further-reading" title="Permalink to this heading">¶</a></h2>
<p>The algorithm used to dynamically estimate <img class="math" src="_images/math/fb0d29f420855f76f8e9deaf5ff8c5580e97a4f0.png" alt="p"/>-quantiles is described
in the paper,</p>
<ul class="simple">
<li><p>R. Jain and I. Chlamtac.
<em>The P^2 algorithm for dynamic calculation of quantiles and histograms without storing observations</em>,
Communications of the ACM, Volume 28 (October), Number 10, 1985,
p. 1076-1085.</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="movstat.html" class="btn btn-neutral float-right" title="Moving Window Statistics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="statistics.html" class="btn btn-neutral float-left" title="Statistics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 1996-2024 The GSL Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>