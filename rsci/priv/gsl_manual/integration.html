

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Numerical Integration &mdash; GSL 2.8 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Random Number Generation" href="rng.html" />
    <link rel="prev" title="Fast Fourier Transforms (FFTs)" href="fft.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> GSL
          

          
          </a>

          
            
            
              <div class="version">
                2.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Using the Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="err.html">Error Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="math.html">Mathematical Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="complex.html">Complex Numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="poly.html">Polynomials</a></li>
<li class="toctree-l1"><a class="reference internal" href="specfunc.html">Special Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectors.html">Vectors and Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="permutation.html">Permutations</a></li>
<li class="toctree-l1"><a class="reference internal" href="combination.html">Combinations</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiset.html">Multisets</a></li>
<li class="toctree-l1"><a class="reference internal" href="sort.html">Sorting</a></li>
<li class="toctree-l1"><a class="reference internal" href="blas.html">BLAS Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="linalg.html">Linear Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="eigen.html">Eigensystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="fft.html">Fast Fourier Transforms (FFTs)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Numerical Integration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#integrands-without-weight-functions">Integrands without weight functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integrands-with-weight-functions">Integrands with weight functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integrands-with-singular-weight-functions">Integrands with singular weight functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#qng-non-adaptive-gauss-kronrod-integration">QNG non-adaptive Gauss-Kronrod integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qag-adaptive-integration">QAG adaptive integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qags-adaptive-integration-with-singularities">QAGS adaptive integration with singularities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qagp-adaptive-integration-with-known-singular-points">QAGP adaptive integration with known singular points</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qagi-adaptive-integration-on-infinite-intervals">QAGI adaptive integration on infinite intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qawc-adaptive-integration-for-cauchy-principal-values">QAWC adaptive integration for Cauchy principal values</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qaws-adaptive-integration-for-singular-functions">QAWS adaptive integration for singular functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qawo-adaptive-integration-for-oscillatory-functions">QAWO adaptive integration for oscillatory functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qawf-adaptive-integration-for-fourier-integrals">QAWF adaptive integration for Fourier integrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cquad-doubly-adaptive-integration">CQUAD doubly-adaptive integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#romberg-integration">Romberg integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gauss-legendre-integration">Gauss-Legendre integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fixed-point-quadratures">Fixed point quadratures</a></li>
<li class="toctree-l2"><a class="reference internal" href="#integrating-on-the-unit-sphere">Integrating on the unit sphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="#error-codes">Error codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adaptive-integration-example">Adaptive integration example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fixed-point-quadrature-example">Fixed-point quadrature example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references-and-further-reading">References and Further Reading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rng.html">Random Number Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="qrng.html">Quasi-Random Sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="randist.html">Random Number Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="statistics.html">Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="rstat.html">Running Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="movstat.html">Moving Window Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="filter.html">Digital Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="histogram.html">Histograms</a></li>
<li class="toctree-l1"><a class="reference internal" href="ntuple.html">N-tuples</a></li>
<li class="toctree-l1"><a class="reference internal" href="montecarlo.html">Monte Carlo Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="siman.html">Simulated Annealing</a></li>
<li class="toctree-l1"><a class="reference internal" href="ode-initval.html">Ordinary Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="interp.html">Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="diff.html">Numerical Differentiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="cheb.html">Chebyshev Approximations</a></li>
<li class="toctree-l1"><a class="reference internal" href="sum.html">Series Acceleration</a></li>
<li class="toctree-l1"><a class="reference internal" href="dwt.html">Wavelet Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="dht.html">Discrete Hankel Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="roots.html">One Dimensional Root-Finding</a></li>
<li class="toctree-l1"><a class="reference internal" href="min.html">One Dimensional Minimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiroots.html">Multidimensional Root-Finding</a></li>
<li class="toctree-l1"><a class="reference internal" href="multimin.html">Multidimensional Minimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="lls.html">Linear Least-Squares Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="nls.html">Nonlinear Least-Squares Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="bspline.html">Basis Splines</a></li>
<li class="toctree-l1"><a class="reference internal" href="spmatrix.html">Sparse Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="spblas.html">Sparse BLAS Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="splinalg.html">Sparse Linear Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="const.html">Physical Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="ieee754.html">IEEE floating-point arithmetic</a></li>
<li class="toctree-l1"><a class="reference internal" href="debug.html">Debugging Numerical Programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="contrib.html">Contributors to GSL</a></li>
<li class="toctree-l1"><a class="reference internal" href="autoconf.html">Autoconf Macros</a></li>
<li class="toctree-l1"><a class="reference internal" href="cblas.html">GSL CBLAS Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpl.html">GNU General Public License</a></li>
<li class="toctree-l1"><a class="reference internal" href="fdl.html">GNU Free Documentation License</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GSL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Numerical Integration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/integration.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="rng.html" class="btn btn-neutral float-right" title="Random Number Generation" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="fft.html" class="btn btn-neutral float-left" title="Fast Fourier Transforms (FFTs)" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="numerical-integration">
<span id="index-0"></span><h1>Numerical Integration<a class="headerlink" href="#numerical-integration" title="Permalink to this heading">¶</a></h1>
<p>This chapter describes routines for performing numerical integration
(quadrature) of a function in one dimension.  There are routines for
adaptive and non-adaptive integration of general functions, with
specialised routines for specific cases.  These include integration over
infinite and semi-infinite ranges, singular integrals, including
logarithmic singularities, computation of Cauchy principal values and
oscillatory integrals.  The library reimplements the algorithms used in
QUADPACK, a numerical integration package written by Piessens,
de Doncker-Kapenga, Ueberhuber and Kahaner.  Fortran code for QUADPACK is
available on Netlib.  Also included are non-adaptive, fixed-order
Gauss-Legendre integration routines with high precision coefficients, as
well as fixed-order quadrature rules for a variety of weighting functions
from IQPACK.</p>
<p>The functions described in this chapter are declared in the header file
<code class="file docutils literal notranslate"><span class="pre">gsl_integration.h</span></code>.</p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>Each algorithm computes an approximation to a definite integral of the
form,</p>
<div class="math">
<p><img src="_images/math/30c5154a742c0fd1840d5888a01abcee0c9126c3.png" alt="I = \int_a^b f(x) w(x) dx"/></p>
</div><p>where <img class="math" src="_images/math/056440286f1dcfb2ce5f20460695c51cb5e2cb60.png" alt="w(x)"/> is a weight function (for general integrands <img class="math" src="_images/math/d0cc6236acb92888620384d61c00b96869613df2.png" alt="w(x) = 1"/>).
The user provides absolute and relative error bounds
<img class="math" src="_images/math/1c2a41cd26065b2df8eab294d502c24fb41f3f46.png" alt="(epsabs, epsrel)"/> which specify the following accuracy requirement,</p>
<div class="math">
<p><img src="_images/math/dd2c3d7e9d9474a9bbc4c0aa2cfc566ecf02d05a.png" alt="|RESULT - I| \leq \max{(epsabs, epsrel |I|)}"/></p>
</div><p>where <img class="math" src="_images/math/4c30847043c5f588972bbd53a80671b22a494f55.png" alt="RESULT"/> is the numerical approximation obtained by the
algorithm.  The algorithms attempt to estimate the absolute error
<img class="math" src="_images/math/b5d20fbdf0ef3b721979432332c55e31efba2450.png" alt="ABSERR = |RESULT - I|"/> in such a way that the following inequality
holds,</p>
<div class="math">
<p><img src="_images/math/e11aea6b9d4c4e638d6e7f311cb26d895e914230.png" alt="|RESULT - I| \leq ABSERR \leq \max{(epsabs, epsrel |I|)}"/></p>
</div><p>In short, the routines return the first approximation
which has an absolute error smaller than
<img class="math" src="_images/math/5db2b800abc73e23396ddd859ab85013187f61ef.png" alt="epsabs"/> or a relative error smaller than <img class="math" src="_images/math/9f424851b17ffc36a7a90544aa51d8b25a3673a9.png" alt="epsrel"/>.</p>
<p>Note that this is an <em>either-or</em> constraint,
not simultaneous.  To compute to a specified absolute error, set
<img class="math" src="_images/math/9f424851b17ffc36a7a90544aa51d8b25a3673a9.png" alt="epsrel"/> to zero.  To compute to a specified relative error,
set <img class="math" src="_images/math/5db2b800abc73e23396ddd859ab85013187f61ef.png" alt="epsabs"/> to zero.
The routines will fail to converge if the error bounds are too
stringent, but always return the best approximation obtained up to
that stage.</p>
<p>The algorithms in QUADPACK use a naming convention based on the
following letters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">-</span> <span class="n">quadrature</span> <span class="n">routine</span>

<span class="n">N</span> <span class="o">-</span> <span class="n">non</span><span class="o">-</span><span class="n">adaptive</span> <span class="n">integrator</span>
<span class="n">A</span> <span class="o">-</span> <span class="n">adaptive</span> <span class="n">integrator</span>

<span class="n">G</span> <span class="o">-</span> <span class="n">general</span> <span class="n">integrand</span> <span class="p">(</span><span class="n">user</span><span class="o">-</span><span class="n">defined</span><span class="p">)</span>
<span class="n">W</span> <span class="o">-</span> <span class="n">weight</span> <span class="n">function</span> <span class="k">with</span> <span class="n">integrand</span>

<span class="n">S</span> <span class="o">-</span> <span class="n">singularities</span> <span class="n">can</span> <span class="n">be</span> <span class="n">more</span> <span class="n">readily</span> <span class="n">integrated</span>
<span class="n">P</span> <span class="o">-</span> <span class="n">points</span> <span class="n">of</span> <span class="n">special</span> <span class="n">difficulty</span> <span class="n">can</span> <span class="n">be</span> <span class="n">supplied</span>
<span class="n">I</span> <span class="o">-</span> <span class="n">infinite</span> <span class="nb">range</span> <span class="n">of</span> <span class="n">integration</span>
<span class="n">O</span> <span class="o">-</span> <span class="n">oscillatory</span> <span class="n">weight</span> <span class="n">function</span><span class="p">,</span> <span class="n">cos</span> <span class="ow">or</span> <span class="n">sin</span>
<span class="n">F</span> <span class="o">-</span> <span class="n">Fourier</span> <span class="n">integral</span>
<span class="n">C</span> <span class="o">-</span> <span class="n">Cauchy</span> <span class="n">principal</span> <span class="n">value</span>
</pre></div>
</div>
<p>The algorithms are built on pairs of quadrature rules, a higher order
rule and a lower order rule.  The higher order rule is used to compute
the best approximation to an integral over a small range.  The
difference between the results of the higher order rule and the lower
order rule gives an estimate of the error in the approximation.</p>
<div class="section" id="integrands-without-weight-functions">
<span id="index-1"></span><h3>Integrands without weight functions<a class="headerlink" href="#integrands-without-weight-functions" title="Permalink to this heading">¶</a></h3>
<p>The algorithms for general functions (without a weight function) are
based on Gauss-Kronrod rules.</p>
<p>A Gauss-Kronrod rule begins with a classical Gaussian quadrature rule of
order <img class="math" src="_images/math/d8aab746990b1e68a457b5fa326f991469488b82.png" alt="m"/>.  This is extended with additional points between each of
the abscissae to give a higher order Kronrod rule of order <img class="math" src="_images/math/98c02e5d2586b4cf5e45465582e935c96d6ce0cb.png" alt="2m + 1"/>.
The Kronrod rule is efficient because it reuses existing function
evaluations from the Gaussian rule.</p>
<p>The higher order Kronrod rule is used as the best approximation to the
integral, and the difference between the two rules is used as an
estimate of the error in the approximation.</p>
</div>
<div class="section" id="integrands-with-weight-functions">
<h3>Integrands with weight functions<a class="headerlink" href="#integrands-with-weight-functions" title="Permalink to this heading">¶</a></h3>
<p id="index-2">For integrands with weight functions the algorithms use Clenshaw-Curtis
quadrature rules.</p>
<p>A Clenshaw-Curtis rule begins with an <img class="math" src="_images/math/f43dc929f43b9ea0d06d0c87855b9e50ee4479ea.png" alt="n"/>-th order Chebyshev
polynomial approximation to the integrand.  This polynomial can be
integrated exactly to give an approximation to the integral of the
original function.  The Chebyshev expansion can be extended to higher
orders to improve the approximation and provide an estimate of the
error.</p>
</div>
<div class="section" id="integrands-with-singular-weight-functions">
<h3>Integrands with singular weight functions<a class="headerlink" href="#integrands-with-singular-weight-functions" title="Permalink to this heading">¶</a></h3>
<p>The presence of singularities (or other behavior) in the integrand can
cause slow convergence in the Chebyshev approximation.  The modified
Clenshaw-Curtis rules used in QUADPACK separate out several common
weight functions which cause slow convergence.</p>
<p>These weight functions are integrated analytically against the Chebyshev
polynomials to precompute <em>modified Chebyshev moments</em>.  Combining
the moments with the Chebyshev approximation to the function gives the
desired integral.  The use of analytic integration for the singular part
of the function allows exact cancellations and substantially improves
the overall convergence behavior of the integration.</p>
</div>
</div>
<div class="section" id="qng-non-adaptive-gauss-kronrod-integration">
<h2>QNG non-adaptive Gauss-Kronrod integration<a class="headerlink" href="#qng-non-adaptive-gauss-kronrod-integration" title="Permalink to this heading">¶</a></h2>
<p id="index-3">The QNG algorithm is a non-adaptive procedure which uses fixed
Gauss-Kronrod-Patterson abscissae to sample the integrand at a maximum of 87
points.  It is provided for fast integration of smooth functions.</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qng">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qng</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="roots.html#c.gsl_function" title="gsl_function"><span class="n"><span class="pre">gsl_function</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">f</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">a</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">b</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsabs</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsrel</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">result</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">abserr</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">neval</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qng" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function applies the Gauss-Kronrod 10-point, 21-point, 43-point and
87-point integration rules in succession until an estimate of the
integral of <img class="math" src="_images/math/297ac74049e250d35993e62353e189c7bfda5398.png" alt="f"/> over <img class="math" src="_images/math/46b305ccf637139f4aa1f00a65184776d577ca14.png" alt="(a,b)"/> is achieved within the desired
absolute and relative error limits, <a class="reference internal" href="#c.gsl_integration_qng" title="epsabs"><code class="xref c c-data docutils literal notranslate"><span class="pre">epsabs</span></code></a> and <a class="reference internal" href="#c.gsl_integration_qng" title="epsrel"><code class="xref c c-data docutils literal notranslate"><span class="pre">epsrel</span></code></a>.  The
function returns the final approximation, <a class="reference internal" href="#c.gsl_integration_qng" title="result"><code class="xref c c-data docutils literal notranslate"><span class="pre">result</span></code></a>, an estimate of
the absolute error, <a class="reference internal" href="#c.gsl_integration_qng" title="abserr"><code class="xref c c-data docutils literal notranslate"><span class="pre">abserr</span></code></a> and the number of function evaluations
used, <a class="reference internal" href="#c.gsl_integration_qng" title="neval"><code class="xref c c-data docutils literal notranslate"><span class="pre">neval</span></code></a>.  The Gauss-Kronrod rules are designed in such a way
that each rule uses all the results of its predecessors, in order to
minimize the total number of function evaluations.</p>
</dd></dl>

</div>
<div class="section" id="qag-adaptive-integration">
<h2>QAG adaptive integration<a class="headerlink" href="#qag-adaptive-integration" title="Permalink to this heading">¶</a></h2>
<p id="index-4">The QAG algorithm is a simple adaptive integration procedure.  The
integration region is divided into subintervals, and on each iteration
the subinterval with the largest estimated error is bisected.  This
reduces the overall error rapidly, as the subintervals become
concentrated around local difficulties in the integrand.  These
subintervals are managed by the following struct,</p>
<dl class="c type">
<dt class="sig sig-object c" id="c.gsl_integration_workspace">
<span class="k"><span class="pre">type</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_workspace</span></span></span><a class="headerlink" href="#c.gsl_integration_workspace" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This workspace handles the memory for the subinterval ranges, results and error
estimates.</p>
</dd></dl>

<span class="target" id="index-5"></span><dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_workspace_alloc">
<a class="reference internal" href="#c.gsl_integration_workspace" title="gsl_integration_workspace"><span class="n"><span class="pre">gsl_integration_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_workspace_alloc</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_workspace_alloc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function allocates a workspace sufficient to hold <a class="reference internal" href="#c.gsl_integration_workspace_alloc" title="n"><code class="xref c c-data docutils literal notranslate"><span class="pre">n</span></code></a> double
precision intervals, their integration results and error estimates.
One workspace may be used multiple times as all necessary reinitialization
is performed automatically by the integration routines.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_workspace_free">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_workspace_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.gsl_integration_workspace" title="gsl_integration_workspace"><span class="n"><span class="pre">gsl_integration_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_workspace_free" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function frees the memory associated with the workspace <a class="reference internal" href="#c.gsl_integration_workspace_free" title="w"><code class="xref c c-data docutils literal notranslate"><span class="pre">w</span></code></a>.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qag">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qag</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="roots.html#c.gsl_function" title="gsl_function"><span class="n"><span class="pre">gsl_function</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">f</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">a</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">b</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsabs</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsrel</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">limit</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">key</span></span>, <a class="reference internal" href="#c.gsl_integration_workspace" title="gsl_integration_workspace"><span class="n"><span class="pre">gsl_integration_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">workspace</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">result</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">abserr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qag" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function applies an integration rule adaptively until an estimate
of the integral of <img class="math" src="_images/math/297ac74049e250d35993e62353e189c7bfda5398.png" alt="f"/> over <img class="math" src="_images/math/46b305ccf637139f4aa1f00a65184776d577ca14.png" alt="(a,b)"/> is achieved within the
desired absolute and relative error limits, <a class="reference internal" href="#c.gsl_integration_qag" title="epsabs"><code class="xref c c-data docutils literal notranslate"><span class="pre">epsabs</span></code></a> and
<a class="reference internal" href="#c.gsl_integration_qag" title="epsrel"><code class="xref c c-data docutils literal notranslate"><span class="pre">epsrel</span></code></a>.  The function returns the final approximation,
<a class="reference internal" href="#c.gsl_integration_qag" title="result"><code class="xref c c-data docutils literal notranslate"><span class="pre">result</span></code></a>, and an estimate of the absolute error, <a class="reference internal" href="#c.gsl_integration_qag" title="abserr"><code class="xref c c-data docutils literal notranslate"><span class="pre">abserr</span></code></a>.  The
integration rule is determined by the value of <a class="reference internal" href="#c.gsl_integration_qag" title="key"><code class="xref c c-data docutils literal notranslate"><span class="pre">key</span></code></a>, which should
be chosen from the following symbolic names,</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 90%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Symbolic Name</p></th>
<th class="head"><p>Key</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">GSL_INTEG_GAUSS15</span></code></p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">GSL_INTEG_GAUSS21</span></code></p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">GSL_INTEG_GAUSS31</span></code></p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">GSL_INTEG_GAUSS41</span></code></p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">GSL_INTEG_GAUSS51</span></code></p></td>
<td><p>5</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">GSL_INTEG_GAUSS61</span></code></p></td>
<td><p>6</p></td>
</tr>
</tbody>
</table>
<p>corresponding to the 15, 21, 31, 41, 51 and 61 point Gauss-Kronrod
rules.  The higher-order rules give better accuracy for smooth functions,
while lower-order rules save time when the function contains local
difficulties, such as discontinuities.</p>
<p>On each iteration the adaptive integration strategy bisects the interval
with the largest error estimate.  The subintervals and their results are
stored in the memory provided by <a class="reference internal" href="#c.gsl_integration_qag" title="workspace"><code class="xref c c-data docutils literal notranslate"><span class="pre">workspace</span></code></a>.  The maximum number of
subintervals is given by <a class="reference internal" href="#c.gsl_integration_qag" title="limit"><code class="xref c c-data docutils literal notranslate"><span class="pre">limit</span></code></a>, which may not exceed the allocated
size of the workspace.</p>
</dd></dl>

</div>
<div class="section" id="qags-adaptive-integration-with-singularities">
<h2>QAGS adaptive integration with singularities<a class="headerlink" href="#qags-adaptive-integration-with-singularities" title="Permalink to this heading">¶</a></h2>
<p id="index-6">The presence of an integrable singularity in the integration region
causes an adaptive routine to concentrate new subintervals around the
singularity.  As the subintervals decrease in size the successive
approximations to the integral converge in a limiting fashion.  This
approach to the limit can be accelerated using an extrapolation
procedure.  The QAGS algorithm combines adaptive bisection with the Wynn
epsilon-algorithm to speed up the integration of many types of
integrable singularities.</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qags">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qags</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="roots.html#c.gsl_function" title="gsl_function"><span class="n"><span class="pre">gsl_function</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">f</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">a</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">b</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsabs</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsrel</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">limit</span></span>, <a class="reference internal" href="#c.gsl_integration_workspace" title="gsl_integration_workspace"><span class="n"><span class="pre">gsl_integration_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">workspace</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">result</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">abserr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qags" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function applies the Gauss-Kronrod 21-point integration rule
adaptively until an estimate of the integral of <img class="math" src="_images/math/297ac74049e250d35993e62353e189c7bfda5398.png" alt="f"/> over
<img class="math" src="_images/math/46b305ccf637139f4aa1f00a65184776d577ca14.png" alt="(a,b)"/> is achieved within the desired absolute and relative error
limits, <a class="reference internal" href="#c.gsl_integration_qags" title="epsabs"><code class="xref c c-data docutils literal notranslate"><span class="pre">epsabs</span></code></a> and <a class="reference internal" href="#c.gsl_integration_qags" title="epsrel"><code class="xref c c-data docutils literal notranslate"><span class="pre">epsrel</span></code></a>.  The results are extrapolated
using the epsilon-algorithm, which accelerates the convergence of the
integral in the presence of discontinuities and integrable
singularities.  The function returns the final approximation from the
extrapolation, <a class="reference internal" href="#c.gsl_integration_qags" title="result"><code class="xref c c-data docutils literal notranslate"><span class="pre">result</span></code></a>, and an estimate of the absolute error,
<a class="reference internal" href="#c.gsl_integration_qags" title="abserr"><code class="xref c c-data docutils literal notranslate"><span class="pre">abserr</span></code></a>.  The subintervals and their results are stored in the
memory provided by <a class="reference internal" href="#c.gsl_integration_qags" title="workspace"><code class="xref c c-data docutils literal notranslate"><span class="pre">workspace</span></code></a>.  The maximum number of subintervals
is given by <a class="reference internal" href="#c.gsl_integration_qags" title="limit"><code class="xref c c-data docutils literal notranslate"><span class="pre">limit</span></code></a>, which may not exceed the allocated size of the
workspace.</p>
</dd></dl>

</div>
<div class="section" id="qagp-adaptive-integration-with-known-singular-points">
<h2>QAGP adaptive integration with known singular points<a class="headerlink" href="#qagp-adaptive-integration-with-known-singular-points" title="Permalink to this heading">¶</a></h2>
<span class="target" id="index-7"></span><dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qagp">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qagp</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="roots.html#c.gsl_function" title="gsl_function"><span class="n"><span class="pre">gsl_function</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">f</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pts</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsabs</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsrel</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">limit</span></span>, <a class="reference internal" href="#c.gsl_integration_workspace" title="gsl_integration_workspace"><span class="n"><span class="pre">gsl_integration_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">workspace</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">result</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">abserr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qagp" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function applies the adaptive integration algorithm QAGS taking
account of the user-supplied locations of singular points.  The array
<a class="reference internal" href="#c.gsl_integration_qagp" title="pts"><code class="xref c c-data docutils literal notranslate"><span class="pre">pts</span></code></a> of length <a class="reference internal" href="#c.gsl_integration_qagp" title="npts"><code class="xref c c-data docutils literal notranslate"><span class="pre">npts</span></code></a> should contain the endpoints of the
integration ranges defined by the integration region and locations of
the singularities.  For example, to integrate over the region
<img class="math" src="_images/math/46b305ccf637139f4aa1f00a65184776d577ca14.png" alt="(a,b)"/> with break-points at <img class="math" src="_images/math/d91d0689d0d6afdb9dc4a2de939d02756f2a255e.png" alt="x_1, x_2, x_3"/> (where
<img class="math" src="_images/math/365c9dba73f5e0c147af788a2504f57939943900.png" alt="a &lt; x_1 &lt; x_2 &lt; x_3 &lt; b"/>) the following <a class="reference internal" href="#c.gsl_integration_qagp" title="pts"><code class="xref c c-data docutils literal notranslate"><span class="pre">pts</span></code></a> array should be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
<span class="n">pts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_1</span>
<span class="n">pts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_2</span>
<span class="n">pts</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_3</span>
<span class="n">pts</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span>
</pre></div>
</div>
<p>with <a class="reference internal" href="#c.gsl_integration_qagp" title="npts"><code class="xref c c-data docutils literal notranslate"><span class="pre">npts</span></code></a> = 5.</p>
<p>If you know the locations of the singular points in the integration
region then this routine will be faster than <a class="reference internal" href="#c.gsl_integration_qags" title="gsl_integration_qags"><code class="xref c c-func docutils literal notranslate"><span class="pre">gsl_integration_qags()</span></code></a>.</p>
</dd></dl>

</div>
<div class="section" id="qagi-adaptive-integration-on-infinite-intervals">
<h2>QAGI adaptive integration on infinite intervals<a class="headerlink" href="#qagi-adaptive-integration-on-infinite-intervals" title="Permalink to this heading">¶</a></h2>
<span class="target" id="index-8"></span><dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qagi">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qagi</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="roots.html#c.gsl_function" title="gsl_function"><span class="n"><span class="pre">gsl_function</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">f</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsabs</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsrel</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">limit</span></span>, <a class="reference internal" href="#c.gsl_integration_workspace" title="gsl_integration_workspace"><span class="n"><span class="pre">gsl_integration_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">workspace</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">result</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">abserr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qagi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function computes the integral of the function <a class="reference internal" href="#c.gsl_integration_qagi" title="f"><code class="xref c c-data docutils literal notranslate"><span class="pre">f</span></code></a> over the
infinite interval <img class="math" src="_images/math/bb22cfc1ee5d96632f04dba05101120f514ffc60.png" alt="(-\infty,+\infty)"/>.  The integral is mapped onto the
semi-open interval <img class="math" src="_images/math/a0063095d691b496eed43bd797d9f2a70fb01541.png" alt="(0,1]"/> using the transformation <img class="math" src="_images/math/cdaf82ac6cd05b2f3b46fe052acc2d2d078bf151.png" alt="x = (1-t)/t"/>,</p>
<div class="math">
<p><img src="_images/math/4cd4b9b3f64e27d8f42917f27da7978ae9576485.png" alt="\int_{-\infty}^{+\infty} dx f(x) = \int_0^1 dt (f((1-t)/t) + f(-(1-t)/t))/t^2."/></p>
</div><p>It is then integrated using the QAGS algorithm.  The normal 21-point
Gauss-Kronrod rule of QAGS is replaced by a 15-point rule, because the
transformation can generate an integrable singularity at the origin.  In
this case a lower-order rule is more efficient.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qagiu">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qagiu</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="roots.html#c.gsl_function" title="gsl_function"><span class="n"><span class="pre">gsl_function</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">f</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">a</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsabs</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsrel</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">limit</span></span>, <a class="reference internal" href="#c.gsl_integration_workspace" title="gsl_integration_workspace"><span class="n"><span class="pre">gsl_integration_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">workspace</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">result</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">abserr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qagiu" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function computes the integral of the function <a class="reference internal" href="#c.gsl_integration_qagiu" title="f"><code class="xref c c-data docutils literal notranslate"><span class="pre">f</span></code></a> over the
semi-infinite interval <img class="math" src="_images/math/34dea26807d92dd798409d51e3fe93288131cf4f.png" alt="(a,+\infty)"/>.  The integral is mapped onto the
semi-open interval <img class="math" src="_images/math/a0063095d691b496eed43bd797d9f2a70fb01541.png" alt="(0,1]"/> using the transformation <img class="math" src="_images/math/0c81ed7b1e880407b9cfc2714705ae57e5a2bbd6.png" alt="x = a + (1-t)/t"/>,</p>
<div class="math">
<p><img src="_images/math/9ddbef04f78f9ca26f534d7e30b02af58f34c87b.png" alt="\int_{a}^{+\infty} dx f(x) = \int_0^1 dt f(a + (1-t)/t)/t^2"/></p>
</div><p>and then integrated using the QAGS algorithm.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qagil">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qagil</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="roots.html#c.gsl_function" title="gsl_function"><span class="n"><span class="pre">gsl_function</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">f</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">b</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsabs</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsrel</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">limit</span></span>, <a class="reference internal" href="#c.gsl_integration_workspace" title="gsl_integration_workspace"><span class="n"><span class="pre">gsl_integration_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">workspace</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">result</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">abserr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qagil" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function computes the integral of the function <a class="reference internal" href="#c.gsl_integration_qagil" title="f"><code class="xref c c-data docutils literal notranslate"><span class="pre">f</span></code></a> over the
semi-infinite interval <img class="math" src="_images/math/36602e852eb86a45be2c84d3e24bfeba01625cca.png" alt="(-\infty,b)"/>.  The integral is mapped onto the
semi-open interval <img class="math" src="_images/math/a0063095d691b496eed43bd797d9f2a70fb01541.png" alt="(0,1]"/> using the transformation <img class="math" src="_images/math/37191f2d2cbe061ee164c7ed65b3ea67ea690cb8.png" alt="x = b - (1-t)/t"/>,</p>
<div class="math">
<p><img src="_images/math/4c85743ac46b12cea40190c45acd7b00bb76a2a8.png" alt="\int_{-\infty}^{b} dx f(x) = \int_0^1 dt f(b - (1-t)/t)/t^2"/></p>
</div><p>and then integrated using the QAGS algorithm.</p>
</dd></dl>

</div>
<div class="section" id="qawc-adaptive-integration-for-cauchy-principal-values">
<h2>QAWC adaptive integration for Cauchy principal values<a class="headerlink" href="#qawc-adaptive-integration-for-cauchy-principal-values" title="Permalink to this heading">¶</a></h2>
<span class="target" id="index-9"></span><dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qawc">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qawc</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="roots.html#c.gsl_function" title="gsl_function"><span class="n"><span class="pre">gsl_function</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">f</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">a</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">b</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">c</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsabs</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsrel</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">limit</span></span>, <a class="reference internal" href="#c.gsl_integration_workspace" title="gsl_integration_workspace"><span class="n"><span class="pre">gsl_integration_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">workspace</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">result</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">abserr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qawc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function computes the Cauchy principal value of the integral of
<img class="math" src="_images/math/297ac74049e250d35993e62353e189c7bfda5398.png" alt="f"/> over <img class="math" src="_images/math/46b305ccf637139f4aa1f00a65184776d577ca14.png" alt="(a,b)"/>, with a singularity at <a class="reference internal" href="#c.gsl_integration_qawc" title="c"><code class="xref c c-data docutils literal notranslate"><span class="pre">c</span></code></a>,</p>
<div class="math">
<p><img src="_images/math/2233351d19677d4d4922c95e6ea0f438e87a95c2.png" alt="I = \int_a^b dx\, {f(x) \over x - c}
  = \lim_{\epsilon \to 0}
\left\{
\int_a^{c-\epsilon} dx\, {f(x) \over x - c}
+
\int_{c+\epsilon}^b dx\, {f(x) \over x - c}
\right\}"/></p>
</div><p>The adaptive bisection algorithm of QAG is used, with modifications to
ensure that subdivisions do not occur at the singular point <img class="math" src="_images/math/ca46b1fb94d8fc69ba885c3595c8139651687cf7.png" alt="x = c"/>.
When a subinterval contains the point <img class="math" src="_images/math/ca46b1fb94d8fc69ba885c3595c8139651687cf7.png" alt="x = c"/> or is close to
it then a special 25-point modified Clenshaw-Curtis rule is used to control
the singularity.  Further away from the
singularity the algorithm uses an ordinary 15-point Gauss-Kronrod
integration rule.</p>
</dd></dl>

</div>
<div class="section" id="qaws-adaptive-integration-for-singular-functions">
<h2>QAWS adaptive integration for singular functions<a class="headerlink" href="#qaws-adaptive-integration-for-singular-functions" title="Permalink to this heading">¶</a></h2>
<p id="index-10">The QAWS algorithm is designed for integrands with algebraic-logarithmic
singularities at the end-points of an integration region.  In order to
work efficiently the algorithm requires a precomputed table of
Chebyshev moments.</p>
<dl class="c type">
<dt class="sig sig-object c" id="c.gsl_integration_qaws_table">
<span class="k"><span class="pre">type</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qaws_table</span></span></span><a class="headerlink" href="#c.gsl_integration_qaws_table" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This structure contains precomputed quantities for the QAWS algorithm.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qaws_table_alloc">
<a class="reference internal" href="#c.gsl_integration_qaws_table" title="gsl_integration_qaws_table"><span class="n"><span class="pre">gsl_integration_qaws_table</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qaws_table_alloc</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">alpha</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">beta</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">mu</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">nu</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qaws_table_alloc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function allocates space for a <a class="reference internal" href="#c.gsl_integration_qaws_table" title="gsl_integration_qaws_table"><code class="xref c c-type docutils literal notranslate"><span class="pre">gsl_integration_qaws_table</span></code></a>
struct describing a singular weight function
<img class="math" src="_images/math/056440286f1dcfb2ce5f20460695c51cb5e2cb60.png" alt="w(x)"/> with the parameters <img class="math" src="_images/math/332ea36d1211ad3e05e7d78b025c520678170844.png" alt="(\alpha, \beta, \mu, \nu)"/>,</p>
<div class="math">
<p><img src="_images/math/876a6fc1bb80c31f898343045f4eac3371566fb2.png" alt="w(x) = (x - a)^\alpha (b - x)^\beta \log^\mu (x - a) \log^\nu (b - x)"/></p>
</div><p>where <img class="math" src="_images/math/28aa486322b74bf6e70eeb3dde72685719d6f45d.png" alt="\alpha &gt; -1"/>, <img class="math" src="_images/math/755503581fd5ce92b134e96d2fd5a73400719bc3.png" alt="\beta &gt; -1"/>, and <img class="math" src="_images/math/d0c71425ad73c5d6988cd78be08969f888fab997.png" alt="\mu = 0, 1"/>,
<img class="math" src="_images/math/90e5bfe4fd554abda2c535f2a6645b6d82dda302.png" alt="\nu = 0, 1"/>.  The weight function can take four different forms
depending on the values of <img class="math" src="_images/math/7d29918417bdbeb6749620d5f24e09c1080dd299.png" alt="\mu"/> and <img class="math" src="_images/math/25f363e3892b0d108cd45bfa18382aca47f09dc2.png" alt="\nu"/>,</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 78%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Weight function <img class="math" src="_images/math/056440286f1dcfb2ce5f20460695c51cb5e2cb60.png" alt="w(x)"/></p></th>
<th class="head"><p><img class="math" src="_images/math/ac59b3cd1982661df5e40a4607cb976b60bf77ab.png" alt="(\mu,\nu)"/></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><img class="math" src="_images/math/b4a30454560fa3dd3e8caef458b48cf0e5b8a7b9.png" alt="(x - a)^\alpha (b - x)^\beta"/></p></td>
<td><p><img class="math" src="_images/math/abb5b0ad20dea12880ed826c6670ba76eb831672.png" alt="(0,0)"/></p></td>
</tr>
<tr class="row-odd"><td><p><img class="math" src="_images/math/39cc6b3078ba7e6092b2807935e1312a36acc1b9.png" alt="(x - a)^\alpha (b - x)^\beta \log{(x-a)}"/></p></td>
<td><p><img class="math" src="_images/math/02319bffb250731d42c840b4dcc9e227b0cb6be3.png" alt="(1,0)"/></p></td>
</tr>
<tr class="row-even"><td><p><img class="math" src="_images/math/4a89203695a919033dc5c18d6b2187a9e3ffec52.png" alt="(x - a)^\alpha (b - x)^\beta \log{(b-x)}"/></p></td>
<td><p><img class="math" src="_images/math/ad5486ab58c04fead190d5ac91d7db84daf14502.png" alt="(0,1)"/></p></td>
</tr>
<tr class="row-odd"><td><p><img class="math" src="_images/math/e9eca76111fe8b660c79c8178335579b9aeba6c3.png" alt="(x - a)^\alpha (b - x)^\beta \log{(x-a)} \log{(b-x)}"/></p></td>
<td><p><img class="math" src="_images/math/34c6f1ae54d35982a73ac8ba1dd5b69eecd1c5f4.png" alt="(1,1)"/></p></td>
</tr>
</tbody>
</table>
<p>The singular points <img class="math" src="_images/math/46b305ccf637139f4aa1f00a65184776d577ca14.png" alt="(a,b)"/> do not have to be specified until the
integral is computed, where they are the endpoints of the integration
range.</p>
<p>The function returns a pointer to the newly allocated table
<a class="reference internal" href="#c.gsl_integration_qaws_table" title="gsl_integration_qaws_table"><code class="xref c c-type docutils literal notranslate"><span class="pre">gsl_integration_qaws_table</span></code></a> if no errors were detected, and 0 in
the case of error.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qaws_table_set">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qaws_table_set</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.gsl_integration_qaws_table" title="gsl_integration_qaws_table"><span class="n"><span class="pre">gsl_integration_qaws_table</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">t</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">alpha</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">beta</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">mu</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">nu</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qaws_table_set" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function modifies the parameters <img class="math" src="_images/math/332ea36d1211ad3e05e7d78b025c520678170844.png" alt="(\alpha, \beta, \mu, \nu)"/> of
an existing <a class="reference internal" href="#c.gsl_integration_qaws_table" title="gsl_integration_qaws_table"><code class="xref c c-type docutils literal notranslate"><span class="pre">gsl_integration_qaws_table</span></code></a> struct <a class="reference internal" href="#c.gsl_integration_qaws_table_set" title="t"><code class="xref c c-data docutils literal notranslate"><span class="pre">t</span></code></a>.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qaws_table_free">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qaws_table_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.gsl_integration_qaws_table" title="gsl_integration_qaws_table"><span class="n"><span class="pre">gsl_integration_qaws_table</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qaws_table_free" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function frees all the memory associated with the
<a class="reference internal" href="#c.gsl_integration_qaws_table" title="gsl_integration_qaws_table"><code class="xref c c-type docutils literal notranslate"><span class="pre">gsl_integration_qaws_table</span></code></a> struct <a class="reference internal" href="#c.gsl_integration_qaws_table_free" title="t"><code class="xref c c-data docutils literal notranslate"><span class="pre">t</span></code></a>.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qaws">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qaws</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="roots.html#c.gsl_function" title="gsl_function"><span class="n"><span class="pre">gsl_function</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">f</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">b</span></span>, <a class="reference internal" href="#c.gsl_integration_qaws_table" title="gsl_integration_qaws_table"><span class="n"><span class="pre">gsl_integration_qaws_table</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">t</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsabs</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsrel</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">limit</span></span>, <a class="reference internal" href="#c.gsl_integration_workspace" title="gsl_integration_workspace"><span class="n"><span class="pre">gsl_integration_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">workspace</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">result</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">abserr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qaws" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function computes the integral of the function <img class="math" src="_images/math/affcac78cbf3ede97b9d3996b222aff08b185b08.png" alt="f(x)"/> over the
interval <img class="math" src="_images/math/46b305ccf637139f4aa1f00a65184776d577ca14.png" alt="(a,b)"/> with the singular weight function
<img class="math" src="_images/math/7efcb4f08687a3c9a723bc16dab71f325b3349e1.png" alt="(x-a)^\alpha (b-x)^\beta \log^\mu (x-a) \log^\nu (b-x)"/>.  The parameters
of the weight function <img class="math" src="_images/math/332ea36d1211ad3e05e7d78b025c520678170844.png" alt="(\alpha, \beta, \mu, \nu)"/> are taken from the
table <a class="reference internal" href="#c.gsl_integration_qaws" title="t"><code class="xref c c-data docutils literal notranslate"><span class="pre">t</span></code></a>.  The integral is,</p>
<div class="math">
<p><img src="_images/math/d43e1e04a39d83b3008bfb8609a2f7c79060635f.png" alt="I = \int_a^b dx f(x) (x - a)^\alpha (b - x)^\beta \log^\mu (x - a) \log^\nu (b - x)."/></p>
</div><p>The adaptive bisection algorithm of QAG is used.  When a subinterval
contains one of the endpoints then a special 25-point modified
Clenshaw-Curtis rule is used to control the singularities.  For
subintervals which do not include the endpoints an ordinary 15-point
Gauss-Kronrod integration rule is used.</p>
</dd></dl>

</div>
<div class="section" id="qawo-adaptive-integration-for-oscillatory-functions">
<h2>QAWO adaptive integration for oscillatory functions<a class="headerlink" href="#qawo-adaptive-integration-for-oscillatory-functions" title="Permalink to this heading">¶</a></h2>
<p id="index-11">The QAWO algorithm is designed for integrands with an oscillatory
factor, <img class="math" src="_images/math/2a29003569bea44c9dd757404e00162b9abcac98.png" alt="\sin(\omega x)"/> or <img class="math" src="_images/math/7cfd676ac1b53a67aac1cd1d543586e209c6b45f.png" alt="\cos(\omega x)"/>.  In order to
work efficiently the algorithm requires a table of Chebyshev moments
which must be pre-computed with calls to the functions below.</p>
<span class="target" id="index-12"></span><dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qawo_table_alloc">
<span class="n"><span class="pre">gsl_integration_qawo_table</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qawo_table_alloc</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">omega</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">L</span></span>, <span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="n"><span class="pre">gsl_integration_qawo_enum</span></span><span class="w"> </span><span class="n"><span class="pre">sine</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qawo_table_alloc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function allocates space for a <code class="xref c c-type docutils literal notranslate"><span class="pre">gsl_integration_qawo_table</span></code>
struct and its associated workspace describing a sine or cosine weight
function <img class="math" src="_images/math/056440286f1dcfb2ce5f20460695c51cb5e2cb60.png" alt="w(x)"/> with the parameters <img class="math" src="_images/math/ec130aeb133d6ac8c14ce8cf79ac6d5988602f0d.png" alt="(\omega, L)"/>,</p>
<div class="math">
<p><img src="_images/math/c19cf67b8251a36ea82316eef1046e8d82af354c.png" alt="w(x) =
\left\{
\begin{array}{c}
\sin{(\omega x)} \\
\cos{(\omega x)} \\
\end{array}
\right\}"/></p>
</div><p>The parameter <a class="reference internal" href="#c.gsl_integration_qawo_table_alloc" title="L"><code class="xref c c-data docutils literal notranslate"><span class="pre">L</span></code></a> must be the length of the interval over which the
function will be integrated <img class="math" src="_images/math/630942e6a96ff427ce9337427cb5e4c801b85319.png" alt="L = b - a"/>.  The choice of sine or
cosine is made with the parameter <a class="reference internal" href="#c.gsl_integration_qawo_table_alloc" title="sine"><code class="xref c c-data docutils literal notranslate"><span class="pre">sine</span></code></a> which should be chosen from
one of the two following symbolic values:</p>
<dl class="c macro">
<dt class="sig sig-object c" id="c.gsl_integration_qawo_table_alloc.GSL_INTEG_COSINE">
<span class="sig-name descname"><span class="n"><span class="pre">GSL_INTEG_COSINE</span></span></span><a class="headerlink" href="#c.gsl_integration_qawo_table_alloc.GSL_INTEG_COSINE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.gsl_integration_qawo_table_alloc.GSL_INTEG_SINE">
<span class="sig-name descname"><span class="n"><span class="pre">GSL_INTEG_SINE</span></span></span><a class="headerlink" href="#c.gsl_integration_qawo_table_alloc.GSL_INTEG_SINE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>The <code class="xref c c-type docutils literal notranslate"><span class="pre">gsl_integration_qawo_table</span></code> is a table of the trigonometric
coefficients required in the integration process.  The parameter <a class="reference internal" href="#c.gsl_integration_qawo_table_alloc" title="n"><code class="xref c c-data docutils literal notranslate"><span class="pre">n</span></code></a>
determines the number of levels of coefficients that are computed.  Each
level corresponds to one bisection of the interval <img class="math" src="_images/math/022e294d9cc6b55633e3693ba894200d32b283ad.png" alt="L"/>, so that
<a class="reference internal" href="#c.gsl_integration_qawo_table_alloc" title="n"><code class="xref c c-data docutils literal notranslate"><span class="pre">n</span></code></a> levels are sufficient for subintervals down to the length
<img class="math" src="_images/math/a95c2b0e68b973d3e07b0d1dd254e7ede40a9dfb.png" alt="L/2^n"/>.  The integration routine <a class="reference internal" href="#c.gsl_integration_qawo" title="gsl_integration_qawo"><code class="xref c c-func docutils literal notranslate"><span class="pre">gsl_integration_qawo()</span></code></a>
returns the error <code class="code docutils literal notranslate"><span class="pre">GSL_ETABLE</span></code> if the number of levels is
insufficient for the requested accuracy.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qawo_table_set">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qawo_table_set</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">gsl_integration_qawo_table</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">t</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">omega</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">L</span></span>, <span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="n"><span class="pre">gsl_integration_qawo_enum</span></span><span class="w"> </span><span class="n"><span class="pre">sine</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qawo_table_set" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function changes the parameters <a class="reference internal" href="#c.gsl_integration_qawo_table_set" title="omega"><code class="xref c c-data docutils literal notranslate"><span class="pre">omega</span></code></a>, <a class="reference internal" href="#c.gsl_integration_qawo_table_set" title="L"><code class="xref c c-data docutils literal notranslate"><span class="pre">L</span></code></a> and <a class="reference internal" href="#c.gsl_integration_qawo_table_set" title="sine"><code class="xref c c-data docutils literal notranslate"><span class="pre">sine</span></code></a>
of the existing workspace <a class="reference internal" href="#c.gsl_integration_qawo_table_set" title="t"><code class="xref c c-data docutils literal notranslate"><span class="pre">t</span></code></a>.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qawo_table_set_length">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qawo_table_set_length</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">gsl_integration_qawo_table</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">t</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">L</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qawo_table_set_length" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function allows the length parameter <a class="reference internal" href="#c.gsl_integration_qawo_table_set_length" title="L"><code class="xref c c-data docutils literal notranslate"><span class="pre">L</span></code></a> of the workspace
<a class="reference internal" href="#c.gsl_integration_qawo_table_set_length" title="t"><code class="xref c c-data docutils literal notranslate"><span class="pre">t</span></code></a> to be changed.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qawo_table_free">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qawo_table_free</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">gsl_integration_qawo_table</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qawo_table_free" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function frees all the memory associated with the workspace <a class="reference internal" href="#c.gsl_integration_qawo_table_free" title="t"><code class="xref c c-data docutils literal notranslate"><span class="pre">t</span></code></a>.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qawo">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qawo</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="roots.html#c.gsl_function" title="gsl_function"><span class="n"><span class="pre">gsl_function</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">f</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsabs</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsrel</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">limit</span></span>, <a class="reference internal" href="#c.gsl_integration_workspace" title="gsl_integration_workspace"><span class="n"><span class="pre">gsl_integration_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">workspace</span></span>, <span class="n"><span class="pre">gsl_integration_qawo_table</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">wf</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">result</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">abserr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qawo" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function uses an adaptive algorithm to compute the integral of
<img class="math" src="_images/math/297ac74049e250d35993e62353e189c7bfda5398.png" alt="f"/> over <img class="math" src="_images/math/46b305ccf637139f4aa1f00a65184776d577ca14.png" alt="(a,b)"/> with the weight function
<img class="math" src="_images/math/2a29003569bea44c9dd757404e00162b9abcac98.png" alt="\sin(\omega x)"/> or <img class="math" src="_images/math/7cfd676ac1b53a67aac1cd1d543586e209c6b45f.png" alt="\cos(\omega x)"/> defined
by the table <a class="reference internal" href="#c.gsl_integration_qawo" title="wf"><code class="xref c c-data docutils literal notranslate"><span class="pre">wf</span></code></a>,</p>
<div class="math">
<p><img src="_images/math/862a5b54ef645f9fae56e1fe7c84ea1527c8eb66.png" alt="I = \int_a^b dx f(x)
\left\{
\begin{array}{c}
\sin{(\omega x)} \\
\cos{(\omega x)}
\end{array}
\right\}"/></p>
</div><p>The results are extrapolated using the epsilon-algorithm to accelerate
the convergence of the integral.  The function returns the final
approximation from the extrapolation, <a class="reference internal" href="#c.gsl_integration_qawo" title="result"><code class="xref c c-data docutils literal notranslate"><span class="pre">result</span></code></a>, and an estimate of
the absolute error, <a class="reference internal" href="#c.gsl_integration_qawo" title="abserr"><code class="xref c c-data docutils literal notranslate"><span class="pre">abserr</span></code></a>.  The subintervals and their results are
stored in the memory provided by <a class="reference internal" href="#c.gsl_integration_qawo" title="workspace"><code class="xref c c-data docutils literal notranslate"><span class="pre">workspace</span></code></a>.  The maximum number of
subintervals is given by <a class="reference internal" href="#c.gsl_integration_qawo" title="limit"><code class="xref c c-data docutils literal notranslate"><span class="pre">limit</span></code></a>, which may not exceed the allocated
size of the workspace.</p>
<p>Those subintervals with “large” widths <img class="math" src="_images/math/92f093ef8e67b2293db7509b06c7817f327f445c.png" alt="d"/> where <img class="math" src="_images/math/6dc612efe91e9b9c98c470c134e86c7056f1b77b.png" alt="d\omega &gt; 4"/> are
computed using a 25-point Clenshaw-Curtis integration rule, which handles the
oscillatory behavior.  Subintervals with a “small” widths where
<img class="math" src="_images/math/3f131f65e5deeaebaeb1feb203756980ea490f52.png" alt="d\omega &lt; 4"/> are computed using a 15-point Gauss-Kronrod integration.</p>
</dd></dl>

</div>
<div class="section" id="qawf-adaptive-integration-for-fourier-integrals">
<h2>QAWF adaptive integration for Fourier integrals<a class="headerlink" href="#qawf-adaptive-integration-for-fourier-integrals" title="Permalink to this heading">¶</a></h2>
<span class="target" id="index-13"></span><dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_qawf">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_qawf</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="roots.html#c.gsl_function" title="gsl_function"><span class="n"><span class="pre">gsl_function</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">f</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsabs</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">limit</span></span>, <a class="reference internal" href="#c.gsl_integration_workspace" title="gsl_integration_workspace"><span class="n"><span class="pre">gsl_integration_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">workspace</span></span>, <a class="reference internal" href="#c.gsl_integration_workspace" title="gsl_integration_workspace"><span class="n"><span class="pre">gsl_integration_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cycle_workspace</span></span>, <span class="n"><span class="pre">gsl_integration_qawo_table</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">wf</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">result</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">abserr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_qawf" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function attempts to compute a Fourier integral of the function
<a class="reference internal" href="#c.gsl_integration_qawf" title="f"><code class="xref c c-data docutils literal notranslate"><span class="pre">f</span></code></a> over the semi-infinite interval <img class="math" src="_images/math/8db952eaecbfc5401b46cd436f616ac81991fd52.png" alt="[a,+\infty)"/></p>
<div class="math">
<p><img src="_images/math/673a94c84d13f7ef950fc2a9bd71a98c7db9fd35.png" alt="I = \int_a^{+\infty} dx f(x)
\left\{
\begin{array}{c}
\sin{(\omega x)} \\
\cos{(\omega x)}
\end{array}
\right\}"/></p>
</div><p>The parameter <img class="math" src="_images/math/a31bb65e46f286fb35f610c12d45f19d95906054.png" alt="\omega"/> and choice of <img class="math" src="_images/math/92bf63d31494428c4f6eb0ef0f7d831810bac713.png" alt="\sin"/> or <img class="math" src="_images/math/e50a3edda4589be905e77ff28b4ab470fb3679da.png" alt="\cos"/> is
taken from the table <a class="reference internal" href="#c.gsl_integration_qawf" title="wf"><code class="xref c c-data docutils literal notranslate"><span class="pre">wf</span></code></a> (the length <code class="xref c c-data docutils literal notranslate"><span class="pre">L</span></code> can take any value,
since it is overridden by this function to a value appropriate for the
Fourier integration).  The integral is computed using the QAWO algorithm
over each of the subintervals,</p>
<div class="math">
<p><img src="_images/math/4b4ba4d61ec98feec47edfcc9e1ddd2ac6f26f65.png" alt="C_1 &amp;= [a,a+c] \\
C_2 &amp;= [a+c,a+2c] \\
\dots &amp;= \dots \\
C_k &amp;= [a+(k-1)c,a+kc]"/></p>
</div><p>where
<img class="math" src="_images/math/05243678584ee10a6b08ef236df9d8323b53a597.png" alt="c = (2 floor(|\omega|) + 1) \pi/|\omega|"/>.  The width <img class="math" src="_images/math/9d8e96031ca3d760ae8d01f085c4b4b7d82d382e.png" alt="c"/> is
chosen to cover an odd number of periods so that the contributions from
the intervals alternate in sign and are monotonically decreasing when
<a class="reference internal" href="#c.gsl_integration_qawf" title="f"><code class="xref c c-data docutils literal notranslate"><span class="pre">f</span></code></a> is positive and monotonically decreasing.  The sum of this
sequence of contributions is accelerated using the epsilon-algorithm.</p>
<p>This function works to an overall absolute tolerance of
<a class="reference internal" href="#c.gsl_integration_qawf" title="abserr"><code class="xref c c-data docutils literal notranslate"><span class="pre">abserr</span></code></a>.  The following strategy is used: on each interval
<img class="math" src="_images/math/a4c6c19de688b48f03e5ea466294caf117cdae2c.png" alt="C_k"/> the algorithm tries to achieve the tolerance</p>
<div class="math">
<p><img src="_images/math/4edd106fd566677ccd7863dbfad0afe58b10f942.png" alt="TOL_k = u_k abserr"/></p>
</div><p>where
<img class="math" src="_images/math/9e8388e89e840cc16ec683246cac37035b8396af.png" alt="u_k = (1 - p)p^{k-1}"/> and <img class="math" src="_images/math/17ffef22aeba3eb34090f2198df201d7caa8e934.png" alt="p = 9/10"/>.
The sum of the geometric series of contributions from each interval
gives an overall tolerance of <a class="reference internal" href="#c.gsl_integration_qawf" title="abserr"><code class="xref c c-data docutils literal notranslate"><span class="pre">abserr</span></code></a>.</p>
<p>If the integration of a subinterval leads to difficulties then the
accuracy requirement for subsequent intervals is relaxed,</p>
<div class="math">
<p><img src="_images/math/ad6aa3ea7e3e12640e3572d27595e8b13cb6adba.png" alt="TOL_k = u_k \max{(abserr, \max_{i&lt;k}{(E_i)})}"/></p>
</div><p>where <img class="math" src="_images/math/58942cad20641c0e874d706503dc121f9e76206a.png" alt="E_k"/> is the estimated error on the interval <img class="math" src="_images/math/a4c6c19de688b48f03e5ea466294caf117cdae2c.png" alt="C_k"/>.</p>
<p>The subintervals and their results are stored in the memory provided by
<a class="reference internal" href="#c.gsl_integration_qawf" title="workspace"><code class="xref c c-data docutils literal notranslate"><span class="pre">workspace</span></code></a>.  The maximum number of subintervals is given by
<a class="reference internal" href="#c.gsl_integration_qawf" title="limit"><code class="xref c c-data docutils literal notranslate"><span class="pre">limit</span></code></a>, which may not exceed the allocated size of the workspace.
The integration over each subinterval uses the memory provided by
<a class="reference internal" href="#c.gsl_integration_qawf" title="cycle_workspace"><code class="xref c c-data docutils literal notranslate"><span class="pre">cycle_workspace</span></code></a> as workspace for the QAWO algorithm.</p>
</dd></dl>

</div>
<div class="section" id="cquad-doubly-adaptive-integration">
<span id="index-14"></span><h2>CQUAD doubly-adaptive integration<a class="headerlink" href="#cquad-doubly-adaptive-integration" title="Permalink to this heading">¶</a></h2>
<p>CQUAD is a new doubly-adaptive general-purpose quadrature
routine which can handle most types of singularities,
non-numerical function values such as <code class="code docutils literal notranslate"><span class="pre">Inf</span></code> or <code class="code docutils literal notranslate"><span class="pre">NaN</span></code>,
as well as some divergent integrals. It generally requires more
function evaluations than the integration routines in
QUADPACK, yet fails less often for difficult integrands.</p>
<p>The underlying algorithm uses a doubly-adaptive scheme in which
Clenshaw-Curtis quadrature rules of increasing degree are used
to compute the integral in each interval. The <img class="math" src="_images/math/89d13caca1dcd1186d6a9f008320ca7c147f9d21.png" alt="L_2"/>-norm of
the difference between the underlying interpolatory polynomials
of two successive rules is used as an error estimate. The
interval is subdivided if the difference between two successive
rules is too large or a rule of maximum degree has been reached.</p>
<span class="target" id="index-15"></span><dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_cquad_workspace_alloc">
<span class="n"><span class="pre">gsl_integration_cquad_workspace</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_cquad_workspace_alloc</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_cquad_workspace_alloc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function allocates a workspace sufficient to hold the data for
<a class="reference internal" href="#c.gsl_integration_cquad_workspace_alloc" title="n"><code class="xref c c-data docutils literal notranslate"><span class="pre">n</span></code></a> intervals. The number <a class="reference internal" href="#c.gsl_integration_cquad_workspace_alloc" title="n"><code class="xref c c-data docutils literal notranslate"><span class="pre">n</span></code></a> is not the maximum number of
intervals that will be evaluated. If the workspace is full, intervals
with smaller error estimates will be discarded. A minimum of 3
intervals is required and for most functions, a workspace of size 100
is sufficient.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_cquad_workspace_free">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_cquad_workspace_free</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">gsl_integration_cquad_workspace</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_cquad_workspace_free" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function frees the memory associated with the workspace <a class="reference internal" href="#c.gsl_integration_cquad_workspace_free" title="w"><code class="xref c c-data docutils literal notranslate"><span class="pre">w</span></code></a>.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_cquad">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_cquad</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="roots.html#c.gsl_function" title="gsl_function"><span class="n"><span class="pre">gsl_function</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">f</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">a</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">b</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsabs</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsrel</span></span>, <span class="n"><span class="pre">gsl_integration_cquad_workspace</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">workspace</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">result</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">abserr</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">nevals</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_cquad" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function computes the integral of <img class="math" src="_images/math/297ac74049e250d35993e62353e189c7bfda5398.png" alt="f"/> over <img class="math" src="_images/math/46b305ccf637139f4aa1f00a65184776d577ca14.png" alt="(a,b)"/>
within the desired absolute and relative error limits, <a class="reference internal" href="#c.gsl_integration_cquad" title="epsabs"><code class="xref c c-data docutils literal notranslate"><span class="pre">epsabs</span></code></a>
and <a class="reference internal" href="#c.gsl_integration_cquad" title="epsrel"><code class="xref c c-data docutils literal notranslate"><span class="pre">epsrel</span></code></a> using the CQUAD algorithm.  The function returns
the final approximation, <a class="reference internal" href="#c.gsl_integration_cquad" title="result"><code class="xref c c-data docutils literal notranslate"><span class="pre">result</span></code></a>, an estimate of the absolute
error, <a class="reference internal" href="#c.gsl_integration_cquad" title="abserr"><code class="xref c c-data docutils literal notranslate"><span class="pre">abserr</span></code></a>, and the number of function evaluations required,
<a class="reference internal" href="#c.gsl_integration_cquad" title="nevals"><code class="xref c c-data docutils literal notranslate"><span class="pre">nevals</span></code></a>.</p>
<p>The CQUAD algorithm divides the integration region into
subintervals, and in each iteration, the subinterval with the largest
estimated error is processed.  The algorithm uses Clenshaw-Curtis
quadrature rules of degree 4, 8, 16 and 32 over 5, 9, 17 and 33 nodes
respectively. Each interval is initialized with the lowest-degree
rule. When an interval is processed, the next-higher degree rule is
evaluated and an error estimate is computed based on the
<img class="math" src="_images/math/89d13caca1dcd1186d6a9f008320ca7c147f9d21.png" alt="L_2"/>-norm of the difference between the underlying interpolating
polynomials of both rules. If the highest-degree rule has already been
used, or the interpolatory polynomials differ significantly, the
interval is bisected.</p>
<p>The subintervals and their results are stored in the memory
provided by <a class="reference internal" href="#c.gsl_integration_cquad" title="workspace"><code class="xref c c-data docutils literal notranslate"><span class="pre">workspace</span></code></a>. If the error estimate or the number of
function evaluations is not needed, the pointers <a class="reference internal" href="#c.gsl_integration_cquad" title="abserr"><code class="xref c c-data docutils literal notranslate"><span class="pre">abserr</span></code></a> and <a class="reference internal" href="#c.gsl_integration_cquad" title="nevals"><code class="xref c c-data docutils literal notranslate"><span class="pre">nevals</span></code></a>
can be set to <code class="code docutils literal notranslate"><span class="pre">NULL</span></code>.</p>
</dd></dl>

</div>
<div class="section" id="romberg-integration">
<h2>Romberg integration<a class="headerlink" href="#romberg-integration" title="Permalink to this heading">¶</a></h2>
<p>The Romberg integration method estimates the definite integral</p>
<div class="math">
<p><img src="_images/math/cd3c79a2916052ab50d375d97c3b8998c812e71b.png" alt="I = \int_a^b f(x) dx"/></p>
</div><p>by applying Richardson extrapolation on the trapezoidal rule, using
equally spaced points with spacing</p>
<div class="math">
<p><img src="_images/math/d6c98d52b3989be993265f9131a3eec3acd0ba27.png" alt="h_k = (b - a) 2^{-k}"/></p>
</div><p>for <img class="math" src="_images/math/5265a8edc495459894f9f272e5fb978dc6319364.png" alt="k = 1, \dots, n"/>. For each <img class="math" src="_images/math/71e6c03676f7f43b827bdaf404bc29149f5d99d7.png" alt="k"/>, Richardson extrapolation
is used <img class="math" src="_images/math/4c7ea67e12bcbba0d5be6a3914a0eb2d17ef2cd7.png" alt="k-1"/> times on previous approximations to improve the order
of accuracy as much as possible. Romberg integration typically works
well (and converges quickly) for smooth integrands with no singularities in
the interval or at the end points.</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_romberg_alloc">
<span class="n"><span class="pre">gsl_integration_romberg_workspace</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_romberg_alloc</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_romberg_alloc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function allocates a workspace for Romberg integration, specifying
a maximum of <img class="math" src="_images/math/f43dc929f43b9ea0d06d0c87855b9e50ee4479ea.png" alt="n"/> iterations, or divisions of the interval. Since
the number of divisions is <img class="math" src="_images/math/6741bd0b15b10b40990f1d513da1e74b427a24da.png" alt="2^n + 1"/>, <img class="math" src="_images/math/f43dc929f43b9ea0d06d0c87855b9e50ee4479ea.png" alt="n"/> can be kept relatively
small (i.e. <img class="math" src="_images/math/8f8a44e9f9b7ef1fb7d0e9585dc08a38a6f89021.png" alt="10"/> or <img class="math" src="_images/math/91f956ce6234e351af3d871173c5c831d77e369f.png" alt="20"/>). It is capped at a maximum value of
<img class="math" src="_images/math/c8cebd5e65871f8a3a80ea5285bd28a2e98262ce.png" alt="30"/> to prevent overflow. The size of the workspace is <img class="math" src="_images/math/14294e3470eb60926c52481f64f66ab82ac5b43d.png" alt="O(2n)"/>.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_romberg_free">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_romberg_free</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">gsl_integration_romberg_workspace</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_romberg_free" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function frees the memory associated with the workspace <a class="reference internal" href="#c.gsl_integration_romberg_free" title="w"><code class="xref c c-data docutils literal notranslate"><span class="pre">w</span></code></a>.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_romberg">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_romberg</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="roots.html#c.gsl_function" title="gsl_function"><span class="n"><span class="pre">gsl_function</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">f</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">b</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsabs</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">epsrel</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">result</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">neval</span></span>, <span class="n"><span class="pre">gsl_integration_romberg_workspace</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_romberg" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function integrates <img class="math" src="_images/math/affcac78cbf3ede97b9d3996b222aff08b185b08.png" alt="f(x)"/>, specified by <a class="reference internal" href="#c.gsl_integration_romberg" title="f"><code class="xref c c-data docutils literal notranslate"><span class="pre">f</span></code></a>, from <a class="reference internal" href="#c.gsl_integration_romberg" title="a"><code class="xref c c-data docutils literal notranslate"><span class="pre">a</span></code></a> to
<a class="reference internal" href="#c.gsl_integration_romberg" title="b"><code class="xref c c-data docutils literal notranslate"><span class="pre">b</span></code></a>, storing the answer in <a class="reference internal" href="#c.gsl_integration_romberg" title="result"><code class="xref c c-data docutils literal notranslate"><span class="pre">result</span></code></a>. At each step in the iteration,
convergence is tested by checking:</p>
<div class="math">
<p><img src="_images/math/451895d6d7bcb4b094e6f6e7f5e9d8defde0646f.png" alt="| I_k - I_{k-1} | \le \textrm{max} \left( epsabs, epsrel \times |I_k| \right)"/></p>
</div><p>where <img class="math" src="_images/math/127c8c8ea72fdf446acfac021f171a5589a5227f.png" alt="I_k"/> is the current approximation and <img class="math" src="_images/math/db23165469f94dd4f3cf3469e75b800d4a4d9476.png" alt="I_{k-1}"/> is the approximation
of the previous iteration. If the method does not converge within the previously
specified <img class="math" src="_images/math/f43dc929f43b9ea0d06d0c87855b9e50ee4479ea.png" alt="n"/> iterations, the function stores the best current estimate in
<a class="reference internal" href="#c.gsl_integration_romberg" title="result"><code class="xref c c-data docutils literal notranslate"><span class="pre">result</span></code></a> and returns <code class="xref c c-macro docutils literal notranslate"><span class="pre">GSL_EMAXITER</span></code>. If the method converges, the function
returns <code class="xref c c-macro docutils literal notranslate"><span class="pre">GSL_SUCCESS</span></code>. The total number of function evaluations is returned
in <a class="reference internal" href="#c.gsl_integration_romberg" title="neval"><code class="xref c c-data docutils literal notranslate"><span class="pre">neval</span></code></a>.</p>
</dd></dl>

</div>
<div class="section" id="gauss-legendre-integration">
<h2>Gauss-Legendre integration<a class="headerlink" href="#gauss-legendre-integration" title="Permalink to this heading">¶</a></h2>
<p>The fixed-order Gauss-Legendre integration routines are provided for fast
integration of smooth functions with known polynomial order.  The
<img class="math" src="_images/math/f43dc929f43b9ea0d06d0c87855b9e50ee4479ea.png" alt="n"/>-point Gauss-Legendre rule is exact for polynomials of order
<img class="math" src="_images/math/8df07e6288922f420effdb6cba8d26e50cbcc822.png" alt="2n - 1"/> or less.  For example, these rules are useful when integrating
basis functions to form mass matrices for the Galerkin method.  Unlike other
numerical integration routines within the library, these routines do not accept
absolute or relative error bounds.</p>
<span class="target" id="index-16"></span><dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_glfixed_table_alloc">
<span class="n"><span class="pre">gsl_integration_glfixed_table</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_glfixed_table_alloc</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_glfixed_table_alloc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function determines the Gauss-Legendre abscissae and weights necessary for
an <img class="math" src="_images/math/f43dc929f43b9ea0d06d0c87855b9e50ee4479ea.png" alt="n"/>-point fixed order integration scheme.  If possible, high precision
precomputed coefficients are used.  If precomputed weights are not available,
lower precision coefficients are computed on the fly.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_glfixed">
<span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_glfixed</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="roots.html#c.gsl_function" title="gsl_function"><span class="n"><span class="pre">gsl_function</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">f</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">a</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">b</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">gsl_integration_glfixed_table</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_glfixed" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function applies the Gauss-Legendre integration rule
contained in table <a class="reference internal" href="#c.gsl_integration_glfixed" title="t"><code class="xref c c-data docutils literal notranslate"><span class="pre">t</span></code></a> and returns the result.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_glfixed_point">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_glfixed_point</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">a</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">b</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">i</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">xi</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">wi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">gsl_integration_glfixed_table</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_glfixed_point" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>For <a class="reference internal" href="#c.gsl_integration_glfixed_point" title="i"><code class="xref c c-data docutils literal notranslate"><span class="pre">i</span></code></a> in <img class="math" src="_images/math/aa265b7178a163409df4e3c362d2368c688fe40d.png" alt="[0, \dots, n - 1]"/>, this function obtains the
<a class="reference internal" href="#c.gsl_integration_glfixed_point" title="i"><code class="xref c c-data docutils literal notranslate"><span class="pre">i</span></code></a>-th Gauss-Legendre point <a class="reference internal" href="#c.gsl_integration_glfixed_point" title="xi"><code class="xref c c-data docutils literal notranslate"><span class="pre">xi</span></code></a> and weight <a class="reference internal" href="#c.gsl_integration_glfixed_point" title="wi"><code class="xref c c-data docutils literal notranslate"><span class="pre">wi</span></code></a> on the interval
[<a class="reference internal" href="#c.gsl_integration_glfixed_point" title="a"><code class="xref c c-data docutils literal notranslate"><span class="pre">a</span></code></a>, <a class="reference internal" href="#c.gsl_integration_glfixed_point" title="b"><code class="xref c c-data docutils literal notranslate"><span class="pre">b</span></code></a>].  The points and weights are ordered by increasing point
value.  A function <img class="math" src="_images/math/297ac74049e250d35993e62353e189c7bfda5398.png" alt="f"/> may be integrated on [<a class="reference internal" href="#c.gsl_integration_glfixed_point" title="a"><code class="xref c c-data docutils literal notranslate"><span class="pre">a</span></code></a>, <a class="reference internal" href="#c.gsl_integration_glfixed_point" title="b"><code class="xref c c-data docutils literal notranslate"><span class="pre">b</span></code></a>] by summing
<img class="math" src="_images/math/e1cc2cd8ff369dc65253ebfad039bbbbaa9b3c1b.png" alt="wi * f(xi)"/> over <a class="reference internal" href="#c.gsl_integration_glfixed_point" title="i"><code class="xref c c-data docutils literal notranslate"><span class="pre">i</span></code></a>.</p>
</dd></dl>

<span class="target" id="index-17"></span><dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_glfixed_table_free">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_glfixed_table_free</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">gsl_integration_glfixed_table</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_glfixed_table_free" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function frees the memory associated with the table <a class="reference internal" href="#c.gsl_integration_glfixed_table_free" title="t"><code class="xref c c-data docutils literal notranslate"><span class="pre">t</span></code></a>.</p>
</dd></dl>

</div>
<div class="section" id="fixed-point-quadratures">
<h2>Fixed point quadratures<a class="headerlink" href="#fixed-point-quadratures" title="Permalink to this heading">¶</a></h2>
<p id="index-18">The routines in this section approximate an integral by the sum</p>
<div class="math">
<p><img src="_images/math/f48204d707015ae91741620b896dd1ad7cf7871a.png" alt="\int_a^b w(x) f(x) dx = \sum_{i=1}^n w_i f(x_i)"/></p>
</div><p>where <img class="math" src="_images/math/affcac78cbf3ede97b9d3996b222aff08b185b08.png" alt="f(x)"/> is the function to be integrated and <img class="math" src="_images/math/056440286f1dcfb2ce5f20460695c51cb5e2cb60.png" alt="w(x)"/> is
a weighting function. The <img class="math" src="_images/math/f43dc929f43b9ea0d06d0c87855b9e50ee4479ea.png" alt="n"/> weights <img class="math" src="_images/math/ece130da0e1e9c9e66b0053903b5cffae6299256.png" alt="w_i"/> and nodes <img class="math" src="_images/math/3efd6fd1c2b0c335484bcd4bf7d5d98b99e619f4.png" alt="x_i"/> are carefully chosen
so that the result is exact when <img class="math" src="_images/math/affcac78cbf3ede97b9d3996b222aff08b185b08.png" alt="f(x)"/> is a polynomial of degree <img class="math" src="_images/math/8df07e6288922f420effdb6cba8d26e50cbcc822.png" alt="2n - 1"/>
or less. Once the user chooses the order <img class="math" src="_images/math/f43dc929f43b9ea0d06d0c87855b9e50ee4479ea.png" alt="n"/> and weighting function <img class="math" src="_images/math/056440286f1dcfb2ce5f20460695c51cb5e2cb60.png" alt="w(x)"/>, the
weights <img class="math" src="_images/math/ece130da0e1e9c9e66b0053903b5cffae6299256.png" alt="w_i"/> and nodes <img class="math" src="_images/math/3efd6fd1c2b0c335484bcd4bf7d5d98b99e619f4.png" alt="x_i"/> can be precomputed and used to efficiently evaluate
integrals for any number of functions <img class="math" src="_images/math/affcac78cbf3ede97b9d3996b222aff08b185b08.png" alt="f(x)"/>.</p>
<p>This method works best when <img class="math" src="_images/math/affcac78cbf3ede97b9d3996b222aff08b185b08.png" alt="f(x)"/> is well approximated by a polynomial on the interval
<img class="math" src="_images/math/46b305ccf637139f4aa1f00a65184776d577ca14.png" alt="(a,b)"/>, and so is not suitable for functions with singularities.
Since the user specifies ahead of time how many quadrature nodes will be used, these
routines do not accept absolute or relative error bounds.  The table below lists
the weighting functions currently supported.</p>
<table class="docutils align-default" id="tab-fixed-quadratures">
<colgroup>
<col style="width: 12%" />
<col style="width: 17%" />
<col style="width: 31%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Interval</p></th>
<th class="head"><p>Weighting function <img class="math" src="_images/math/056440286f1dcfb2ce5f20460695c51cb5e2cb60.png" alt="w(x)"/></p></th>
<th class="head"><p>Constraints</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Legendre</p></td>
<td><p><img class="math" src="_images/math/46b305ccf637139f4aa1f00a65184776d577ca14.png" alt="(a,b)"/></p></td>
<td><p><img class="math" src="_images/math/083794f6b6375b92a331ddd53c8cc62a3a0a2a6d.png" alt="1"/></p></td>
<td><p><img class="math" src="_images/math/0b1a77fc3c6c4cc9b26aa4b544b3e6878b6ba7b5.png" alt="b &gt; a"/></p></td>
</tr>
<tr class="row-odd"><td><p>Chebyshev Type 1</p></td>
<td><p><img class="math" src="_images/math/46b305ccf637139f4aa1f00a65184776d577ca14.png" alt="(a,b)"/></p></td>
<td><p><img class="math" src="_images/math/8e7c44830013cca9d0d4484779faa7a249f7b919.png" alt="1 / \sqrt{(b - x) (x - a)}"/></p></td>
<td><p><img class="math" src="_images/math/0b1a77fc3c6c4cc9b26aa4b544b3e6878b6ba7b5.png" alt="b &gt; a"/></p></td>
</tr>
<tr class="row-even"><td><p>Gegenbauer</p></td>
<td><p><img class="math" src="_images/math/46b305ccf637139f4aa1f00a65184776d577ca14.png" alt="(a,b)"/></p></td>
<td><p><img class="math" src="_images/math/c0bd79456d77abe6b86b505acea9a16d36bfda89.png" alt="((b - x) (x - a))^{\alpha}"/></p></td>
<td><p><img class="math" src="_images/math/d2ebee847e9e04f69482f77f997366101d62c259.png" alt="\alpha &gt; -1, b &gt; a"/></p></td>
</tr>
<tr class="row-odd"><td><p>Jacobi</p></td>
<td><p><img class="math" src="_images/math/46b305ccf637139f4aa1f00a65184776d577ca14.png" alt="(a,b)"/></p></td>
<td><p><img class="math" src="_images/math/8b4ac4be4890886287ce459e6f86e43d2c6194ac.png" alt="(b - x)^{\alpha} (x - a)^{\beta}"/></p></td>
<td><p><img class="math" src="_images/math/c68c85e9c48de62bee04b510ff830f9f0dac1284.png" alt="\alpha,\beta &gt; -1, b &gt; a"/></p></td>
</tr>
<tr class="row-even"><td><p>Laguerre</p></td>
<td><p><img class="math" src="_images/math/eb6e581bf7800a3ba0504caa6271df2e8f5b95c8.png" alt="(a,\infty)"/></p></td>
<td><p><img class="math" src="_images/math/da655541aa8a76b7bfb3cd1ebe5eeb9405741762.png" alt="(x-a)^{\alpha} \exp{( -b (x - a) )}"/></p></td>
<td><p><img class="math" src="_images/math/7269ba134e4d683b441ebf18d00a4f3360f612b9.png" alt="\alpha &gt; -1, b &gt; 0"/></p></td>
</tr>
<tr class="row-odd"><td><p>Hermite</p></td>
<td><p><img class="math" src="_images/math/5aa7b86d49ab6c387b67fd6972a16370edd37630.png" alt="(-\infty,\infty)"/></p></td>
<td><p><img class="math" src="_images/math/43e4fa0f3956f0e705ad3729ef701d6464a3ea2e.png" alt="|x-a|^{\alpha} \exp{( -b (x-a)^2 )}"/></p></td>
<td><p><img class="math" src="_images/math/7269ba134e4d683b441ebf18d00a4f3360f612b9.png" alt="\alpha &gt; -1, b &gt; 0"/></p></td>
</tr>
<tr class="row-even"><td><p>Exponential</p></td>
<td><p><img class="math" src="_images/math/46b305ccf637139f4aa1f00a65184776d577ca14.png" alt="(a,b)"/></p></td>
<td><p><img class="math" src="_images/math/cc0ee1896b142d5ae639e5131ff98c529a6906b6.png" alt="|x - (a + b)/2|^{\alpha}"/></p></td>
<td><p><img class="math" src="_images/math/d2ebee847e9e04f69482f77f997366101d62c259.png" alt="\alpha &gt; -1, b &gt; a"/></p></td>
</tr>
<tr class="row-odd"><td><p>Rational</p></td>
<td><p><img class="math" src="_images/math/eb6e581bf7800a3ba0504caa6271df2e8f5b95c8.png" alt="(a,\infty)"/></p></td>
<td><p><img class="math" src="_images/math/07561d0908049ba60d6aea69cc715b6ce1e4d29f.png" alt="(x - a)^{\alpha} (x + b)^{\beta}"/></p></td>
<td><p><img class="math" src="_images/math/27515396a1a90664752841255587d54560d5a46a.png" alt="\alpha &gt; -1, \alpha + \beta + 2n &lt; 0, a + b &gt; 0"/></p></td>
</tr>
<tr class="row-even"><td><p>Chebyshev Type 2</p></td>
<td><p><img class="math" src="_images/math/46b305ccf637139f4aa1f00a65184776d577ca14.png" alt="(a,b)"/></p></td>
<td><p><img class="math" src="_images/math/3138bd4342dc6c58505a2eb409d85a5cd32b69da.png" alt="\sqrt{(b - x) (x - a)}"/></p></td>
<td><p><img class="math" src="_images/math/0b1a77fc3c6c4cc9b26aa4b544b3e6878b6ba7b5.png" alt="b &gt; a"/></p></td>
</tr>
</tbody>
</table>
<p>The fixed point quadrature routines use the following workspace to store the nodes and weights,
as well as additional variables for intermediate calculations:</p>
<dl class="c type">
<dt class="sig sig-object c" id="c.gsl_integration_fixed_workspace">
<span class="k"><span class="pre">type</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_fixed_workspace</span></span></span><a class="headerlink" href="#c.gsl_integration_fixed_workspace" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This workspace is used for fixed point quadrature rules and looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">struct</span>
<span class="p">{</span>
  <span class="n">size_t</span> <span class="n">n</span><span class="p">;</span>        <span class="o">/*</span> <span class="n">number</span> <span class="n">of</span> <span class="n">nodes</span><span class="o">/</span><span class="n">weights</span> <span class="o">*/</span>
  <span class="n">double</span> <span class="o">*</span><span class="n">weights</span><span class="p">;</span> <span class="o">/*</span> <span class="n">quadrature</span> <span class="n">weights</span> <span class="o">*/</span>
  <span class="n">double</span> <span class="o">*</span><span class="n">x</span><span class="p">;</span>       <span class="o">/*</span> <span class="n">quadrature</span> <span class="n">nodes</span> <span class="o">*/</span>
  <span class="n">double</span> <span class="o">*</span><span class="n">diag</span><span class="p">;</span>    <span class="o">/*</span> <span class="n">diagonal</span> <span class="n">of</span> <span class="n">Jacobi</span> <span class="n">matrix</span> <span class="o">*/</span>
  <span class="n">double</span> <span class="o">*</span><span class="n">subdiag</span><span class="p">;</span> <span class="o">/*</span> <span class="n">subdiagonal</span> <span class="n">of</span> <span class="n">Jacobi</span> <span class="n">matrix</span> <span class="o">*/</span>
  <span class="n">const</span> <span class="n">gsl_integration_fixed_type</span> <span class="o">*</span> <span class="nb">type</span><span class="p">;</span>
<span class="p">}</span> <span class="n">gsl_integration_fixed_workspace</span><span class="p">;</span>
</pre></div>
</div>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_fixed_alloc">
<a class="reference internal" href="#c.gsl_integration_fixed_workspace" title="gsl_integration_fixed_workspace"><span class="n"><span class="pre">gsl_integration_fixed_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_fixed_alloc</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type" title="gsl_integration_fixed_type"><span class="n"><span class="pre">gsl_integration_fixed_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">T</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">n</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">b</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">alpha</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">beta</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_fixed_alloc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function allocates a workspace for computing integrals with interpolating quadratures using <a class="reference internal" href="#c.gsl_integration_fixed_alloc" title="n"><code class="xref c c-data docutils literal notranslate"><span class="pre">n</span></code></a>
quadrature nodes. The parameters <a class="reference internal" href="#c.gsl_integration_fixed_alloc" title="a"><code class="xref c c-data docutils literal notranslate"><span class="pre">a</span></code></a>, <a class="reference internal" href="#c.gsl_integration_fixed_alloc" title="b"><code class="xref c c-data docutils literal notranslate"><span class="pre">b</span></code></a>, <a class="reference internal" href="#c.gsl_integration_fixed_alloc" title="alpha"><code class="xref c c-data docutils literal notranslate"><span class="pre">alpha</span></code></a>, and <a class="reference internal" href="#c.gsl_integration_fixed_alloc" title="beta"><code class="xref c c-data docutils literal notranslate"><span class="pre">beta</span></code></a> specify the integration
interval and/or weighting function for the various quadrature types. See the <a class="reference internal" href="#tab-fixed-quadratures"><span class="std std-ref">table</span></a> above
for constraints on these parameters. The size of the workspace is <img class="math" src="_images/math/d0cb6055def3b95d45bda544d38153f662017dd5.png" alt="O(4n)"/>.</p>
<dl class="c type">
<dt class="sig sig-object c" id="c.gsl_integration_fixed_alloc.gsl_integration_fixed_type">
<span class="k"><span class="pre">type</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_fixed_type</span></span></span><a class="headerlink" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The type of quadrature used is specified by <a class="reference internal" href="#c.gsl_integration_fixed_alloc" title="T"><code class="xref c c-data docutils literal notranslate"><span class="pre">T</span></code></a> which can be set to the following choices:</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_legendre">
<a class="reference internal" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type" title="gsl_integration_fixed_type"><span class="n"><span class="pre">gsl_integration_fixed_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_fixed_legendre</span></span></span><a class="headerlink" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_legendre" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This specifies Legendre quadrature integration. The parameters <a class="reference internal" href="#c.gsl_integration_fixed_alloc" title="alpha"><code class="xref c c-data docutils literal notranslate"><span class="pre">alpha</span></code></a> and
<a class="reference internal" href="#c.gsl_integration_fixed_alloc" title="beta"><code class="xref c c-data docutils literal notranslate"><span class="pre">beta</span></code></a> are ignored for this type.</p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_chebyshev">
<a class="reference internal" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type" title="gsl_integration_fixed_type"><span class="n"><span class="pre">gsl_integration_fixed_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_fixed_chebyshev</span></span></span><a class="headerlink" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_chebyshev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This specifies Chebyshev type 1 quadrature integration. The parameters <a class="reference internal" href="#c.gsl_integration_fixed_alloc" title="alpha"><code class="xref c c-data docutils literal notranslate"><span class="pre">alpha</span></code></a> and
<a class="reference internal" href="#c.gsl_integration_fixed_alloc" title="beta"><code class="xref c c-data docutils literal notranslate"><span class="pre">beta</span></code></a> are ignored for this type.</p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_gegenbauer">
<a class="reference internal" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type" title="gsl_integration_fixed_type"><span class="n"><span class="pre">gsl_integration_fixed_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_fixed_gegenbauer</span></span></span><a class="headerlink" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_gegenbauer" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This specifies Gegenbauer quadrature integration. The parameter <a class="reference internal" href="#c.gsl_integration_fixed_alloc" title="beta"><code class="xref c c-data docutils literal notranslate"><span class="pre">beta</span></code></a> is ignored for this type.</p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_jacobi">
<a class="reference internal" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type" title="gsl_integration_fixed_type"><span class="n"><span class="pre">gsl_integration_fixed_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_fixed_jacobi</span></span></span><a class="headerlink" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_jacobi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This specifies Jacobi quadrature integration.</p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_laguerre">
<a class="reference internal" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type" title="gsl_integration_fixed_type"><span class="n"><span class="pre">gsl_integration_fixed_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_fixed_laguerre</span></span></span><a class="headerlink" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_laguerre" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This specifies Laguerre quadrature integration. The parameter <a class="reference internal" href="#c.gsl_integration_fixed_alloc" title="beta"><code class="xref c c-data docutils literal notranslate"><span class="pre">beta</span></code></a> is ignored for this type.</p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_hermite">
<a class="reference internal" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type" title="gsl_integration_fixed_type"><span class="n"><span class="pre">gsl_integration_fixed_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_fixed_hermite</span></span></span><a class="headerlink" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_hermite" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This specifies Hermite quadrature integration. The parameter <a class="reference internal" href="#c.gsl_integration_fixed_alloc" title="beta"><code class="xref c c-data docutils literal notranslate"><span class="pre">beta</span></code></a> is ignored for this type.</p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_exponential">
<a class="reference internal" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type" title="gsl_integration_fixed_type"><span class="n"><span class="pre">gsl_integration_fixed_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_fixed_exponential</span></span></span><a class="headerlink" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_exponential" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This specifies exponential quadrature integration. The parameter <a class="reference internal" href="#c.gsl_integration_fixed_alloc" title="beta"><code class="xref c c-data docutils literal notranslate"><span class="pre">beta</span></code></a> is ignored for this type.</p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_rational">
<a class="reference internal" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type" title="gsl_integration_fixed_type"><span class="n"><span class="pre">gsl_integration_fixed_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_fixed_rational</span></span></span><a class="headerlink" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_rational" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This specifies rational quadrature integration.</p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_chebyshev2">
<a class="reference internal" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type" title="gsl_integration_fixed_type"><span class="n"><span class="pre">gsl_integration_fixed_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_fixed_chebyshev2</span></span></span><a class="headerlink" href="#c.gsl_integration_fixed_alloc.gsl_integration_fixed_type.gsl_integration_fixed_chebyshev2" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This specifies Chebyshev type 2 quadrature integration. The parameters <a class="reference internal" href="#c.gsl_integration_fixed_alloc" title="alpha"><code class="xref c c-data docutils literal notranslate"><span class="pre">alpha</span></code></a> and
<a class="reference internal" href="#c.gsl_integration_fixed_alloc" title="beta"><code class="xref c c-data docutils literal notranslate"><span class="pre">beta</span></code></a> are ignored for this type.</p>
</dd></dl>

</dd></dl>

</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_fixed_free">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_fixed_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.gsl_integration_fixed_workspace" title="gsl_integration_fixed_workspace"><span class="n"><span class="pre">gsl_integration_fixed_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_fixed_free" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function frees the memory assocated with the workspace <a class="reference internal" href="#c.gsl_integration_fixed_free" title="w"><code class="xref c c-data docutils literal notranslate"><span class="pre">w</span></code></a></p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_fixed_n">
<span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_fixed_n</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.gsl_integration_fixed_workspace" title="gsl_integration_fixed_workspace"><span class="n"><span class="pre">gsl_integration_fixed_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_fixed_n" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function returns the number of quadrature nodes and weights.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_fixed_nodes">
<span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_fixed_nodes</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.gsl_integration_fixed_workspace" title="gsl_integration_fixed_workspace"><span class="n"><span class="pre">gsl_integration_fixed_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_fixed_nodes" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function returns a pointer to an array of size <code class="xref c c-data docutils literal notranslate"><span class="pre">n</span></code> containing the quadrature nodes <img class="math" src="_images/math/3efd6fd1c2b0c335484bcd4bf7d5d98b99e619f4.png" alt="x_i"/>.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_fixed_weights">
<span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_fixed_weights</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.gsl_integration_fixed_workspace" title="gsl_integration_fixed_workspace"><span class="n"><span class="pre">gsl_integration_fixed_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_fixed_weights" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function returns a pointer to an array of size <code class="xref c c-data docutils literal notranslate"><span class="pre">n</span></code> containing the quadrature weights <img class="math" src="_images/math/ece130da0e1e9c9e66b0053903b5cffae6299256.png" alt="w_i"/>.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_fixed">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_fixed</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="roots.html#c.gsl_function" title="gsl_function"><span class="n"><span class="pre">gsl_function</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">func</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">result</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.gsl_integration_fixed_workspace" title="gsl_integration_fixed_workspace"><span class="n"><span class="pre">gsl_integration_fixed_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_fixed" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function integrates the function <img class="math" src="_images/math/affcac78cbf3ede97b9d3996b222aff08b185b08.png" alt="f(x)"/> provided in <a class="reference internal" href="#c.gsl_integration_fixed" title="func"><code class="xref c c-data docutils literal notranslate"><span class="pre">func</span></code></a> using previously
computed fixed quadrature rules. The integral is approximated as</p>
<div class="math">
<p><img src="_images/math/6257378d243611b367145df215b09cb3355c3ea8.png" alt="\sum_{i=1}^n w_i f(x_i)"/></p>
</div><p>where <img class="math" src="_images/math/ece130da0e1e9c9e66b0053903b5cffae6299256.png" alt="w_i"/> are the quadrature weights and <img class="math" src="_images/math/3efd6fd1c2b0c335484bcd4bf7d5d98b99e619f4.png" alt="x_i"/> are the quadrature nodes computed
previously by <a class="reference internal" href="#c.gsl_integration_fixed_alloc" title="gsl_integration_fixed_alloc"><code class="xref c c-func docutils literal notranslate"><span class="pre">gsl_integration_fixed_alloc()</span></code></a>. The sum is stored in <a class="reference internal" href="#c.gsl_integration_fixed" title="result"><code class="xref c c-data docutils literal notranslate"><span class="pre">result</span></code></a> on output.</p>
</dd></dl>

</div>
<div class="section" id="integrating-on-the-unit-sphere">
<h2>Integrating on the unit sphere<a class="headerlink" href="#integrating-on-the-unit-sphere" title="Permalink to this heading">¶</a></h2>
<p id="index-19">This section contains routines to calculate the surface integral of a
function over the unit sphere,</p>
<div class="math">
<p><img src="_images/math/3ed06d12c506ad475a3464d67035b4f340d7cfc3.png" alt="I[f] = \int d\Omega f(\Omega) = \int_0^{\pi} \sin{\theta} d\theta \int_0^{2\pi} d\phi f(\theta,\phi)"/></p>
</div><p>Lebedev developed a quadrature scheme to approximate this integral using a
single sum,</p>
<div class="math">
<p><img src="_images/math/39d288c70fd7bfacf8042e9edacdc02574f657ec.png" alt="I[f] \approx 4 \pi \sum_{i=1}^n w_i f(\theta_i, \phi_i)"/></p>
</div><p>for appropriately chosen weights <img class="math" src="_images/math/ece130da0e1e9c9e66b0053903b5cffae6299256.png" alt="w_i"/> and nodes <img class="math" src="_images/math/117b0cd0ccacbebf9332ecfe487eacf3882ab09b.png" alt="(\theta_i,\phi_i)"/>.
The Lebedev nodes are chosen to lie on the unit sphere and be invariant
under the octahedral rotation group with inversion.</p>
<p>The number of quadrature nodes <img class="math" src="_images/math/f43dc929f43b9ea0d06d0c87855b9e50ee4479ea.png" alt="n"/> is often chosen in order to exactly
integrate a certain degree spherical harmonic function <img class="math" src="_images/math/c1446368e8939941b9effc60b87f5c2ed9fc1e70.png" alt="Y_l^m"/>.
A general rule of thumb for integrating spherical harmonics up to degree
and order <img class="math" src="_images/math/022e294d9cc6b55633e3693ba894200d32b283ad.png" alt="L"/> is to choose the number of nodes as,</p>
<div class="math">
<p><img src="_images/math/d7ecc63af10065561176aad947c2fc8f33505c1f.png" alt="n \approx \frac{(L+1)^2}{3}"/></p>
</div><p>Calculating the Lebedev weights and nodes requires solving a set of nonlinear
equations. These equations have been solved, and the nodes and weights have
been tabulated for integrating spherical harmonics up to degree and order 131.
GSL offers a smaller subset of 32 quadrature rules, which are listed in
the table below.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 48%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Spherical Harmonic degree <img class="math" src="_images/math/022e294d9cc6b55633e3693ba894200d32b283ad.png" alt="L"/></p></th>
<th class="head"><p>Quadrature weights and nodes <img class="math" src="_images/math/f43dc929f43b9ea0d06d0c87855b9e50ee4479ea.png" alt="n"/></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>3</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>14</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>26</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>38</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>50</p></td>
</tr>
<tr class="row-odd"><td><p>13</p></td>
<td><p>74</p></td>
</tr>
<tr class="row-even"><td><p>15</p></td>
<td><p>86</p></td>
</tr>
<tr class="row-odd"><td><p>17</p></td>
<td><p>110</p></td>
</tr>
<tr class="row-even"><td><p>19</p></td>
<td><p>146</p></td>
</tr>
<tr class="row-odd"><td><p>21</p></td>
<td><p>170</p></td>
</tr>
<tr class="row-even"><td><p>23</p></td>
<td><p>194</p></td>
</tr>
<tr class="row-odd"><td><p>25</p></td>
<td><p>230</p></td>
</tr>
<tr class="row-even"><td><p>27</p></td>
<td><p>266</p></td>
</tr>
<tr class="row-odd"><td><p>29</p></td>
<td><p>302</p></td>
</tr>
<tr class="row-even"><td><p>31</p></td>
<td><p>350</p></td>
</tr>
<tr class="row-odd"><td><p>35</p></td>
<td><p>434</p></td>
</tr>
<tr class="row-even"><td><p>41</p></td>
<td><p>590</p></td>
</tr>
<tr class="row-odd"><td><p>47</p></td>
<td><p>770</p></td>
</tr>
<tr class="row-even"><td><p>53</p></td>
<td><p>974</p></td>
</tr>
<tr class="row-odd"><td><p>59</p></td>
<td><p>1202</p></td>
</tr>
<tr class="row-even"><td><p>65</p></td>
<td><p>1454</p></td>
</tr>
<tr class="row-odd"><td><p>71</p></td>
<td><p>1730</p></td>
</tr>
<tr class="row-even"><td><p>77</p></td>
<td><p>2030</p></td>
</tr>
<tr class="row-odd"><td><p>83</p></td>
<td><p>2354</p></td>
</tr>
<tr class="row-even"><td><p>89</p></td>
<td><p>2702</p></td>
</tr>
<tr class="row-odd"><td><p>95</p></td>
<td><p>3074</p></td>
</tr>
<tr class="row-even"><td><p>101</p></td>
<td><p>3470</p></td>
</tr>
<tr class="row-odd"><td><p>107</p></td>
<td><p>3890</p></td>
</tr>
<tr class="row-even"><td><p>113</p></td>
<td><p>4334</p></td>
</tr>
<tr class="row-odd"><td><p>119</p></td>
<td><p>4802</p></td>
</tr>
<tr class="row-even"><td><p>125</p></td>
<td><p>5294</p></td>
</tr>
<tr class="row-odd"><td><p>131</p></td>
<td><p>5810</p></td>
</tr>
</tbody>
</table>
<dl class="c type">
<dt class="sig sig-object c" id="c.gsl_integration_lebedev_workspace">
<span class="k"><span class="pre">type</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_lebedev_workspace</span></span></span><a class="headerlink" href="#c.gsl_integration_lebedev_workspace" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This workspace is used for Lebedev quadrature rules and looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">struct</span>
<span class="p">{</span>
  <span class="n">size_t</span> <span class="n">n</span><span class="p">;</span>        <span class="o">/*</span> <span class="n">number</span> <span class="n">of</span> <span class="n">nodes</span><span class="o">/</span><span class="n">weights</span> <span class="o">*/</span>
  <span class="n">double</span> <span class="o">*</span><span class="n">weights</span><span class="p">;</span> <span class="o">/*</span> <span class="n">quadrature</span> <span class="n">weights</span> <span class="o">*/</span>
  <span class="n">double</span> <span class="o">*</span><span class="n">x</span><span class="p">;</span>       <span class="o">/*</span> <span class="n">x</span> <span class="n">quadrature</span> <span class="n">nodes</span> <span class="o">*/</span>
  <span class="n">double</span> <span class="o">*</span><span class="n">y</span><span class="p">;</span>       <span class="o">/*</span> <span class="n">y</span> <span class="n">quadrature</span> <span class="n">nodes</span> <span class="o">*/</span>
  <span class="n">double</span> <span class="o">*</span><span class="n">z</span><span class="p">;</span>       <span class="o">/*</span> <span class="n">z</span> <span class="n">quadrature</span> <span class="n">nodes</span> <span class="o">*/</span>
  <span class="n">double</span> <span class="o">*</span><span class="n">theta</span><span class="p">;</span>   <span class="o">/*</span> <span class="n">theta</span> <span class="n">quadrature</span> <span class="n">nodes</span> <span class="o">*/</span>
  <span class="n">double</span> <span class="o">*</span><span class="n">phi</span><span class="p">;</span>     <span class="o">/*</span> <span class="n">phi</span> <span class="n">quadrature</span> <span class="n">nodes</span> <span class="o">*/</span>
<span class="p">}</span> <span class="n">gsl_integration_lebedev_workspace</span><span class="p">;</span>
</pre></div>
</div>
<p>The arrays <code class="xref c c-data docutils literal notranslate"><span class="pre">x</span></code>, <code class="xref c c-data docutils literal notranslate"><span class="pre">y</span></code>, <code class="xref c c-data docutils literal notranslate"><span class="pre">z</span></code> of length <img class="math" src="_images/math/f43dc929f43b9ea0d06d0c87855b9e50ee4479ea.png" alt="n"/>
contain the Cartesian coordinates <img class="math" src="_images/math/73ff39bd0c01ae0b5bb13785d7e00025126767ac.png" alt="(x_i,y_i,z_i)"/> of the
Lebedev nodes which lie on the unit sphere. The arrays
<code class="xref c c-data docutils literal notranslate"><span class="pre">theta</span></code>, <code class="xref c c-data docutils literal notranslate"><span class="pre">phi</span></code> contain the spherical coordinates
<img class="math" src="_images/math/117b0cd0ccacbebf9332ecfe487eacf3882ab09b.png" alt="(\theta_i,\phi_i)"/> of the same nodes on the unit sphere.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_lebedev_alloc">
<a class="reference internal" href="#c.gsl_integration_lebedev_workspace" title="gsl_integration_lebedev_workspace"><span class="n"><span class="pre">gsl_integration_lebedev_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_lebedev_alloc</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_lebedev_alloc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function allocates a workspace for a Lebedev quadrature
rule of size <a class="reference internal" href="#c.gsl_integration_lebedev_alloc" title="n"><code class="xref c c-data docutils literal notranslate"><span class="pre">n</span></code></a> and computes the nodes and weights.
The size of the workspace is <img class="math" src="_images/math/29c1827dd50f7e57efbe7dbb4b58ec008c744381.png" alt="O(6n)"/>.</p>
<p>If the input <a class="reference internal" href="#c.gsl_integration_lebedev_alloc" title="n"><code class="xref c c-data docutils literal notranslate"><span class="pre">n</span></code></a> does not match one of the rules in the
table above, the error code <a class="reference internal" href="err.html#c.GSL_EDOM" title="GSL_EDOM"><code class="xref c c-macro docutils literal notranslate"><span class="pre">GSL_EDOM</span></code></a> is returned.</p>
<p>Here is some example code for integrating a function <img class="math" src="_images/math/d2ebe852faceffb73d1d46501b7c842f83263d58.png" alt="f(\theta,\phi)"/>
with Lebedev quadrature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">const</span> <span class="n">size_t</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">230</span><span class="p">;</span> <span class="o">/*</span> <span class="n">integrate</span> <span class="n">exactly</span> <span class="n">up</span> <span class="n">to</span> <span class="n">spherical</span> <span class="n">harmonic</span> <span class="n">degree</span> <span class="mi">25</span> <span class="o">*/</span>
<span class="n">gsl_integration_lebedev_workspace</span> <span class="o">*</span> <span class="n">w</span> <span class="o">=</span> <span class="n">gsl_integration_lebedev_alloc</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="n">double</span> <span class="n">result</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
<span class="n">size_t</span> <span class="n">i</span><span class="p">;</span>

<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
  <span class="n">result</span> <span class="o">+=</span> <span class="n">w</span><span class="o">-&gt;</span><span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">w</span><span class="o">-&gt;</span><span class="n">theta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">w</span><span class="o">-&gt;</span><span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>

<span class="n">result</span> <span class="o">*=</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">M_PI</span><span class="p">;</span>
<span class="n">gsl_integration_lebedev_free</span><span class="p">(</span><span class="n">w</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_lebedev_free">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_lebedev_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.gsl_integration_lebedev_workspace" title="gsl_integration_lebedev_workspace"><span class="n"><span class="pre">gsl_integration_lebedev_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_lebedev_free" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function frees the memory associated with the workspace <a class="reference internal" href="#c.gsl_integration_lebedev_free" title="w"><code class="xref c c-data docutils literal notranslate"><span class="pre">w</span></code></a>.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.gsl_integration_lebedev_n">
<span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gsl_integration_lebedev_n</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.gsl_integration_lebedev_workspace" title="gsl_integration_lebedev_workspace"><span class="n"><span class="pre">gsl_integration_lebedev_workspace</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.gsl_integration_lebedev_n" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function returns the number of quadrature nodes associated
with the workspace <a class="reference internal" href="#c.gsl_integration_lebedev_n" title="w"><code class="xref c c-data docutils literal notranslate"><span class="pre">w</span></code></a>.</p>
</dd></dl>

</div>
<div class="section" id="error-codes">
<h2>Error codes<a class="headerlink" href="#error-codes" title="Permalink to this heading">¶</a></h2>
<p>In addition to the standard error codes for invalid arguments the
functions can return the following values,</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">GSL_EMAXITER</span></code></p></td>
<td><p>the maximum number of subdivisions was exceeded.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">GSL_EROUND</span></code></p></td>
<td><p>cannot reach tolerance because of roundoff error, or roundoff error was detected in the extrapolation table.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">GSL_ESING</span></code></p></td>
<td><p>a non-integrable singularity or other bad integrand behavior was found in the integration interval.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">GSL_EDIVERGE</span></code></p></td>
<td><p>the integral is divergent, or too slowly convergent to be integrated numerically.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="err.html#c.GSL_EDOM" title="GSL_EDOM"><code class="xref c c-macro docutils literal notranslate"><span class="pre">GSL_EDOM</span></code></a></p></td>
<td><p>error in the values of the input arguments</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h2>
<div class="section" id="adaptive-integration-example">
<h3>Adaptive integration example<a class="headerlink" href="#adaptive-integration-example" title="Permalink to this heading">¶</a></h3>
<p>The integrator <code class="code docutils literal notranslate"><span class="pre">QAGS</span></code> will handle a large class of definite
integrals.  For example, consider the following integral, which has an
algebraic-logarithmic singularity at the origin,</p>
<div class="math">
<p><img src="_images/math/7a6dda514ea7d8969133bfe84380ac6b38ddde6c.png" alt="\int_0^1 x^{-1/2} \log(x) dx = -4"/></p>
</div><p>The program below computes this integral to a relative accuracy bound of
<code class="code docutils literal notranslate"><span class="pre">1e-7</span></code>.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;stdio.h&gt;</span>
<span class="c1">#include &lt;math.h&gt;</span>
<span class="c1">#include &lt;gsl/gsl_integration.h&gt;</span>

<span class="n">double</span> <span class="n">f</span> <span class="p">(</span><span class="n">double</span> <span class="n">x</span><span class="p">,</span> <span class="n">void</span> <span class="o">*</span> <span class="n">params</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">double</span> <span class="n">alpha</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">double</span> <span class="o">*</span><span class="p">)</span> <span class="n">params</span><span class="p">;</span>
  <span class="n">double</span> <span class="n">f</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">f</span><span class="p">;</span>
<span class="p">}</span>

<span class="nb">int</span>
<span class="n">main</span> <span class="p">(</span><span class="n">void</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">gsl_integration_workspace</span> <span class="o">*</span> <span class="n">w</span>
    <span class="o">=</span> <span class="n">gsl_integration_workspace_alloc</span> <span class="p">(</span><span class="mi">1000</span><span class="p">);</span>

  <span class="n">double</span> <span class="n">result</span><span class="p">,</span> <span class="n">error</span><span class="p">;</span>
  <span class="n">double</span> <span class="n">expected</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">;</span>
  <span class="n">double</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>

  <span class="n">gsl_function</span> <span class="n">F</span><span class="p">;</span>
  <span class="n">F</span><span class="o">.</span><span class="n">function</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">f</span><span class="p">;</span>
  <span class="n">F</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">alpha</span><span class="p">;</span>

  <span class="n">gsl_integration_qags</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">F</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1e-7</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span>
                        <span class="n">w</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">result</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>

  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;result          = </span><span class="si">% .18f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;exact result    = </span><span class="si">% .18f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">expected</span><span class="p">);</span>
  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;estimated error = </span><span class="si">% .18f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">);</span>
  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;actual error    = </span><span class="si">% .18f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">result</span> <span class="o">-</span> <span class="n">expected</span><span class="p">);</span>
  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;intervals       = %zu</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">w</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">);</span>

  <span class="n">gsl_integration_workspace_free</span> <span class="p">(</span><span class="n">w</span><span class="p">);</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The results below show that the desired accuracy is achieved after 8
subdivisions.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result</span>          <span class="o">=</span> <span class="o">-</span><span class="mf">4.000000000000085265</span>
<span class="n">exact</span> <span class="n">result</span>    <span class="o">=</span> <span class="o">-</span><span class="mf">4.000000000000000000</span>
<span class="n">estimated</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">0.000000000000135447</span>
<span class="n">actual</span> <span class="n">error</span>    <span class="o">=</span> <span class="o">-</span><span class="mf">0.000000000000085265</span>
<span class="n">intervals</span>       <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
<p>In fact, the extrapolation procedure used by <code class="code docutils literal notranslate"><span class="pre">QAGS</span></code> produces an
accuracy of almost twice as many digits.  The error estimate returned by
the extrapolation procedure is larger than the actual error, giving a
margin of safety of one order of magnitude.</p>
</div>
<div class="section" id="fixed-point-quadrature-example">
<h3>Fixed-point quadrature example<a class="headerlink" href="#fixed-point-quadrature-example" title="Permalink to this heading">¶</a></h3>
<p>In this example, we use a fixed-point quadrature rule to integrate the
integral</p>
<div class="math">
<p><img src="_images/math/f74592aa947f86b58f7b2213e677a2b21bff3a4f.png" alt="\int_{-\infty}^{\infty} e^{-x^2} \left( x^m + 1 \right) dx =
  \left\{
    \begin{array}{cc}
      \sqrt{\pi} + \Gamma{\left( \frac{m+1}{2} \right)}, &amp; m \textrm{ even} \\
      \sqrt{\pi}, &amp; m \textrm{ odd}
    \end{array}
  \right."/></p>
</div><p>for integer <img class="math" src="_images/math/d8aab746990b1e68a457b5fa326f991469488b82.png" alt="m"/>. Consulting our <a class="reference internal" href="#tab-fixed-quadratures"><span class="std std-ref">table</span></a> of fixed point quadratures,
we see that this integral can be evaluated with a Hermite quadrature rule,
setting <img class="math" src="_images/math/309ceeb9659e489b5d325f66772f1651611ba9b0.png" alt="\alpha = 0, a = 0, b = 1"/>. Since we are integrating a polynomial
of degree <img class="math" src="_images/math/d8aab746990b1e68a457b5fa326f991469488b82.png" alt="m"/>, we need to choose the number of nodes <img class="math" src="_images/math/8060c6a3a9ef544970e9f3702dbcc22042513da6.png" alt="n \ge (m+1)/2"/>
to achieve the best results.</p>
<p>First we will try integrating for <img class="math" src="_images/math/3f7c83bb3f545b44d0224b263e483fe64a5372bd.png" alt="m = 10, n = 5"/>, which does not satisfy
our criteria above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./integration2 10 5
</pre></div>
</div>
<p>The output is,</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span>               <span class="o">=</span> <span class="mi">10</span>
<span class="n">intervals</span>       <span class="o">=</span> <span class="mi">5</span>
<span class="n">result</span>          <span class="o">=</span>  <span class="mf">47.468529694563351029</span>
<span class="n">exact</span> <span class="n">result</span>    <span class="o">=</span>  <span class="mf">54.115231635459025483</span>
<span class="n">actual</span> <span class="n">error</span>    <span class="o">=</span> <span class="o">-</span><span class="mf">6.646701940895674454</span>
</pre></div>
</div>
<p>So, we find a large error. Now we try integrating for <img class="math" src="_images/math/e09aeff41c70e393735f38a742c5a1af7627fbc3.png" alt="m = 10, n = 6"/> which
does satisfy the criteria above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./integration2 10 6
</pre></div>
</div>
<p>The output is,</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span>               <span class="o">=</span> <span class="mi">10</span>
<span class="n">intervals</span>       <span class="o">=</span> <span class="mi">6</span>
<span class="n">result</span>          <span class="o">=</span>  <span class="mf">54.115231635459096537</span>
<span class="n">exact</span> <span class="n">result</span>    <span class="o">=</span>  <span class="mf">54.115231635459025483</span>
<span class="n">actual</span> <span class="n">error</span>    <span class="o">=</span>  <span class="mf">0.000000000000071054</span>
</pre></div>
</div>
<p>The program is given below.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;stdio.h&gt;</span>
<span class="c1">#include &lt;math.h&gt;</span>
<span class="c1">#include &lt;gsl/gsl_integration.h&gt;</span>
<span class="c1">#include &lt;gsl/gsl_sf_gamma.h&gt;</span>

<span class="n">double</span>
<span class="n">f</span><span class="p">(</span><span class="n">double</span> <span class="n">x</span><span class="p">,</span> <span class="n">void</span> <span class="o">*</span> <span class="n">params</span><span class="p">)</span>
<span class="p">{</span>
  <span class="nb">int</span> <span class="n">m</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="nb">int</span> <span class="o">*</span><span class="p">)</span> <span class="n">params</span><span class="p">;</span>
  <span class="n">double</span> <span class="n">f</span> <span class="o">=</span> <span class="n">gsl_pow_int</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">f</span><span class="p">;</span>
<span class="p">}</span>

<span class="nb">int</span>
<span class="n">main</span> <span class="p">(</span><span class="nb">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="n">gsl_integration_fixed_workspace</span> <span class="o">*</span> <span class="n">w</span><span class="p">;</span>
  <span class="n">const</span> <span class="n">gsl_integration_fixed_type</span> <span class="o">*</span> <span class="n">T</span> <span class="o">=</span> <span class="n">gsl_integration_fixed_hermite</span><span class="p">;</span>
  <span class="nb">int</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="nb">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
  <span class="n">double</span> <span class="n">expected</span><span class="p">,</span> <span class="n">result</span><span class="p">;</span>
  <span class="n">gsl_function</span> <span class="n">F</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>

  <span class="n">w</span> <span class="o">=</span> <span class="n">gsl_integration_fixed_alloc</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>

  <span class="n">F</span><span class="o">.</span><span class="n">function</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">f</span><span class="p">;</span>
  <span class="n">F</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">;</span>

  <span class="n">gsl_integration_fixed</span><span class="p">(</span><span class="o">&amp;</span><span class="n">F</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">result</span><span class="p">,</span> <span class="n">w</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">expected</span> <span class="o">=</span> <span class="n">M_SQRTPI</span> <span class="o">+</span> <span class="n">gsl_sf_gamma</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">m</span><span class="p">));</span>
  <span class="k">else</span>
    <span class="n">expected</span> <span class="o">=</span> <span class="n">M_SQRTPI</span><span class="p">;</span>

  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;m               = </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">);</span>
  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;intervals       = %zu</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">gsl_integration_fixed_n</span><span class="p">(</span><span class="n">w</span><span class="p">));</span>
  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;result          = </span><span class="si">% .18f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;exact result    = </span><span class="si">% .18f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">expected</span><span class="p">);</span>
  <span class="n">printf</span> <span class="p">(</span><span class="s2">&quot;actual error    = </span><span class="si">% .18f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">result</span> <span class="o">-</span> <span class="n">expected</span><span class="p">);</span>

  <span class="n">gsl_integration_fixed_free</span> <span class="p">(</span><span class="n">w</span><span class="p">);</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="references-and-further-reading">
<h2>References and Further Reading<a class="headerlink" href="#references-and-further-reading" title="Permalink to this heading">¶</a></h2>
<p>The following book is the definitive reference for QUADPACK, and was
written by the original authors.  It provides descriptions of the
algorithms, program listings, test programs and examples.  It also
includes useful advice on numerical integration and many references to
the numerical integration literature used in developing QUADPACK.</p>
<ul class="simple">
<li><p>R. Piessens, E. de Doncker-Kapenga, C.W. Ueberhuber, D.K. Kahaner.
QUADPACK A subroutine package for automatic integration
Springer Verlag, 1983.</p></li>
</ul>
<p>The CQUAD integration algorithm is described in the following paper:</p>
<ul class="simple">
<li><p>P. Gonnet, “Increasing the Reliability of Adaptive Quadrature Using
Explicit Interpolants”, ACM Transactions on Mathematical
Software, Volume 37 (2010), Issue 3, Article 26.</p></li>
</ul>
<p>The fixed-point quadrature routines are based on IQPACK, described in the
following papers:</p>
<ul class="simple">
<li><p>S. Elhay, J. Kautsky, Algorithm 655: IQPACK, FORTRAN Subroutines for the
Weights of Interpolatory Quadrature, ACM Transactions on Mathematical Software,
Volume 13, Number 4, December 1987, pages 399-415.</p></li>
<li><p>J. Kautsky, S. Elhay, Calculation of the Weights of Interpolatory Quadratures,
Numerische Mathematik, Volume 40, Number 3, October 1982, pages 407-422.</p></li>
</ul>
<p>The Lebedev quadrature routines are based on the paper:</p>
<ul class="simple">
<li><p>Lebedev, V. I. and Laikov, D. N. (1999). A quadrature formula for the sphere of
the 131st algebraic order of accuracy. In Doklady Mathematics (Vol. 59, No. 3, pp. 477-481).</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="rng.html" class="btn btn-neutral float-right" title="Random Number Generation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="fft.html" class="btn btn-neutral float-left" title="Fast Fourier Transforms (FFTs)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 1996-2024 The GSL Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>